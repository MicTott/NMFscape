[{"path":"https://mictott.github.io/NMFscape/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"Use chain--thought Senior Bioinformatics R Developer experienced Bioconductor.","code":""},{"path":"https://mictott.github.io/NMFscape/CLAUDE.html","id":"behavior-rules","dir":"","previous_headings":"","what":"Behavior Rules","title":"CLAUDE.md","text":"Never: - Rewrite entire files making small edits - Add comments explaining obvious code - Remove existing comments documentation - Change code style/formatting lines ’re modifying - Add features “improvements” didn’t ask - Summarize ’re - just Always: - Run tests making changes - Make minimal, focused changes - Preserve existing code style - something fails twice, stop explain problem","code":""},{"path":"https://mictott.github.io/NMFscape/CLAUDE.html","id":"communication","dir":"","previous_headings":"","what":"Communication","title":"CLAUDE.md","text":"terse. Skip preamble summaries. unsure, ask ONE specific question - don’t list options Don’t explain code back unless ask stuck, say tried failed","code":""},{"path":"https://mictott.github.io/NMFscape/CLAUDE.html","id":"git","dir":"","previous_headings":"","what":"Git","title":"CLAUDE.md","text":"Commit logical change Use conventional commits: feat:, fix:, docs:, refactor:, test: Don’t amend commits without asking NEVER mention Claude commits","code":""},{"path":"https://mictott.github.io/NMFscape/CLAUDE.html","id":"before-making-changes-check","dir":"","previous_headings":"","what":"Before Making Changes, Check:","title":"CLAUDE.md","text":"DESCRIPTION - version, dependencies NAMESPACE - exports/imports CHANGELOG.md - current focus, recent decisions Relevant R/*.R tests/testthat/*.R files","code":""},{"path":"https://mictott.github.io/NMFscape/CLAUDE.html","id":"bioconductor-rules","dir":"","previous_headings":"","what":"Bioconductor Rules","title":"CLAUDE.md","text":"Never use: - T/F → use TRUE/FALSE - 1:n → use seq_len(n) - 1:length(x) → use seq_along(x) - sapply() → use vapply() FUN.VALUE - library()/require() package code - cat()/print() messages → use message() Version format: x.y.z z odd devel, even release","code":""},{"path":"https://mictott.github.io/NMFscape/CLAUDE.html","id":"naming-conventions","dir":"","previous_headings":"","what":"Naming Conventions","title":"CLAUDE.md","text":"Functions: camelCase (e.g., calculateScore) S4 Classes: PascalCase (e.g., GeneAnnotation) Internal functions: .dotPrefix (e.g., .validateInput) Variables: snake_case","code":""},{"path":"https://mictott.github.io/NMFscape/CLAUDE.html","id":"roxygen-essentials","dir":"","previous_headings":"","what":"Roxygen Essentials","title":"CLAUDE.md","text":"Every exported function needs: @param, @return, @examples, @export","code":""},{"path":"https://mictott.github.io/NMFscape/CLAUDE.html","id":"commands","dir":"","previous_headings":"","what":"Commands","title":"CLAUDE.md","text":"","code":"R -e \"devtools::document(); devtools::test()\"   # Quick cycle R -e \"devtools::check()\"                         # Full check R -e \"BiocCheck::BiocCheck('.')\"                # Bioc check"},{"path":"https://mictott.github.io/NMFscape/articles/BiocNMF.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Fast NMF for Single Cell and Spatial Data with BiocNMF","text":"BiocNMF provides fast non-negative matrix factorization (NMF) SingleCellExperiment SpatialExperiment objects using high-performance RcppML backend. NMF useful dimensionality reduction, feature extraction, identifying patterns genomic data.","code":""},{"path":"https://mictott.github.io/NMFscape/articles/BiocNMF.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Fast NMF for Single Cell and Spatial Data with BiocNMF","text":"","code":"# From Bioconductor (when available) if (!requireNamespace(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\") BiocManager::install(\"BiocNMF\")"},{"path":"https://mictott.github.io/NMFscape/articles/BiocNMF.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick Start","title":"Fast NMF for Single Cell and Spatial Data with BiocNMF","text":"","code":"library(BiocNMF) #> Warning: replacing previous import 'BiocGenerics::sd' by 'stats::sd' when #> loading 'BiocNMF' library(scuttle)"},{"path":"https://mictott.github.io/NMFscape/articles/BiocNMF.html","id":"basic-usage-with-singlecellexperiment","dir":"Articles","previous_headings":"Quick Start","what":"Basic Usage with SingleCellExperiment","title":"Fast NMF for Single Cell and Spatial Data with BiocNMF","text":"","code":"# Create example data sce <- mockSCE(ngenes = 1000, ncells = 200) sce <- logNormCounts(sce)  # Run NMF with 10 factors sce <- runNMF(sce, k = 10, verbose = FALSE)  # Access results nmf_coords <- reducedDim(sce, \"NMF\") dim(nmf_coords) #> [1] 200  10  # Get basis matrix (gene loadings) basis <- getBasis(sce) dim(basis) #> [1] 1000   10  # Get top features for each factor top_genes <- getTopFeatures(sce, n = 5) head(top_genes, 2) #> $NMF_1 #> [1] \"Gene_0713\" \"Gene_0185\" \"Gene_0195\" \"Gene_0413\" \"Gene_0901\" #>  #> $NMF_2 #> [1] \"Gene_0880\" \"Gene_0397\" \"Gene_0869\" \"Gene_0019\" \"Gene_0690\""},{"path":"https://mictott.github.io/NMFscape/articles/BiocNMF.html","id":"advanced-usage","dir":"Articles","previous_headings":"Quick Start","what":"Advanced Usage","title":"Fast NMF for Single Cell and Spatial Data with BiocNMF","text":"","code":"# Use different assay and parameters sce <- runNMF(sce, k = 15, assay = \"logcounts\",                name = \"NMF_15\", L1 = c(0.01, 0.01), verbose = FALSE)  # Multiple NMF results can be stored reducedDimNames(sce) #> [1] \"NMF\"    \"NMF_15\""},{"path":"https://mictott.github.io/NMFscape/articles/BiocNMF.html","id":"consensus-nmf","dir":"Articles","previous_headings":"Quick Start","what":"Consensus NMF","title":"Fast NMF for Single Cell and Spatial Data with BiocNMF","text":"robust results, use consensus NMF runs multiple NMF iterations combines results:","code":"# Run consensus NMF across a range of k values sce <- runConsensusNMF(sce, k_range = 8:12, n_runs = 20, verbose = FALSE)  # Get stability metrics to see optimal k selection stability <- getStabilityMetrics(sce) print(stability) #>    k    stability silhouette reproducibility cophenetic_correlation #> 1  8 0.0080974843  0.5144750      0.26250000                      1 #> 2  9 0.0003724395  0.5150000      0.08333333                      1 #> 3 10 0.0008040201  0.4000237      0.10500000                      1 #> 4 11 0.0009962640  0.4037430      0.11818182                      1 #> 5 12 0.0004184100  0.3114126      0.08333333                      1  # Access consensus results optimal_k <- getOptimalK(sce) geps <- getConsensusGEPs(sce) usage <- getGEPUsage(sce)  # Get top genes for each program top_genes <- getTopGEPFeatures(sce, n = 10) head(top_genes, 2) #> $cNMF_1 #>  [1] \"Gene_0386\" \"Gene_0332\" \"Gene_0006\" \"Gene_0693\" \"Gene_0692\" \"Gene_0632\" #>  [7] \"Gene_0215\" \"Gene_0741\" \"Gene_0017\" \"Gene_0283\" #>  #> $cNMF_2 #>  [1] \"Gene_0690\" \"Gene_0185\" \"Gene_0167\" \"Gene_0713\" \"Gene_0651\" \"Gene_0528\" #>  [7] \"Gene_0811\" \"Gene_0441\" \"Gene_0221\" \"Gene_0387\""},{"path":"https://mictott.github.io/NMFscape/articles/BiocNMF.html","id":"visualization","dir":"Articles","previous_headings":"Quick Start","what":"Visualization","title":"Fast NMF for Single Cell and Spatial Data with BiocNMF","text":"","code":"# Plot stability metrics (requires ggplot2) if (requireNamespace(\"ggplot2\", quietly = TRUE)) {   plotStability(sce)   plotGEPs(sce, programs = 1:3, n_genes = 15) }"},{"path":"https://mictott.github.io/NMFscape/articles/BiocNMF.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Fast NMF for Single Cell and Spatial Data with BiocNMF","text":"","code":"sessionInfo() #> R version 4.4.3 Patched (2025-02-28 r87922) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/New_York #> tzcode source: internal #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] scuttle_1.16.0              BiocNMF_0.99.0              #>  [3] SingleCellExperiment_1.28.1 SummarizedExperiment_1.36.0 #>  [5] Biobase_2.66.0              GenomicRanges_1.58.0        #>  [7] GenomeInfoDb_1.42.3         IRanges_2.40.1              #>  [9] S4Vectors_0.44.0            MatrixGenerics_1.18.1       #> [11] matrixStats_1.5.0           BiocGenerics_0.52.0         #> [13] BiocStyle_2.34.0            #>  #> loaded via a namespace (and not attached): #>  [1] RcppML_0.3.7            sass_0.4.9              SparseArray_1.6.2       #>  [4] lattice_0.22-6          digest_0.6.37           evaluate_1.0.3          #>  [7] grid_4.4.3              bookdown_0.42           fastmap_1.2.0           #> [10] jsonlite_1.9.1          Matrix_1.7-3            BiocManager_1.30.25     #> [13] httr_1.4.7              UCSC.utils_1.2.0        codetools_0.2-20        #> [16] textshaping_1.0.0       jquerylib_0.1.4         abind_1.4-8             #> [19] cli_3.6.4               rlang_1.1.5             crayon_1.5.3            #> [22] XVector_0.46.0          cachem_1.1.0            DelayedArray_0.32.0     #> [25] yaml_2.3.10             S4Arrays_1.6.0          beachmat_2.22.0         #> [28] parallel_4.4.3          tools_4.4.3             BiocParallel_1.40.0     #> [31] GenomeInfoDbData_1.2.13 R6_2.6.1                lifecycle_1.0.4         #> [34] zlibbioc_1.52.0         fs_1.6.5                htmlwidgets_1.6.4       #> [37] ragg_1.5.0              desc_1.4.3              pkgdown_2.1.3           #> [40] bslib_0.9.0             Rcpp_1.1.0              systemfonts_1.2.1       #> [43] xfun_0.51               knitr_1.49              htmltools_0.5.8.1       #> [46] rmarkdown_2.29          compiler_4.4.3"},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with NMFscape","text":"NMFscape provides fast, scalable non-negative matrix factorization (NMF) single-cell spatial transcriptomic data. NMF decomposes gene expression data biologically interpretable gene expression programs (also called “factors” “metagenes”) weighted patterns across cells.","code":""},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"what-is-nmf","dir":"Articles","previous_headings":"Introduction","what":"What is NMF?","title":"Getting Started with NMFscape","text":"Non-negative matrix factorization decomposes gene expression matrix X (genes × cells) two lower-rank matrices: W (genes × k programs): Gene loadings - genes contribute program H (k programs × cells): Cell loadings - much cell uses program key constraint values W H non-negative (≥0), enforces “parts-based” representation programs combine additively. particularly suited biological data gene expression counts inherently non-negative.","code":""},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"why-nmf-for-single-cell-analysis","dir":"Articles","previous_headings":"Introduction","what":"Why NMF for single-cell analysis?","title":"Getting Started with NMFscape","text":"Gene program decomposition: Identifies gene modules work together biological processes Cell type discovery: Programs often correspond cell type-specific signatures, cell states, biological pathways Biologically interpretable: Gene programs represent co-expressed gene modules can used downstream functional enrichment pathway analysis NMFscape uses RcppML high-performance computation integrates seamlessly Bioconductor workflows, storing results directly SingleCellExperiment SpatialExperiment objects.","code":"library(NMFscape) #> Loading required package: BiocGenerics #>  #> Attaching package: 'BiocGenerics' #> The following objects are masked from 'package:stats': #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from 'package:base': #>  #>     anyDuplicated, aperm, append, as.data.frame, basename, cbind, #>     colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find, #>     get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply, #>     match, mget, order, paste, pmax, pmax.int, pmin, pmin.int, #>     Position, rank, rbind, Reduce, rownames, sapply, saveRDS, setdiff, #>     table, tapply, union, unique, unsplit, which.max, which.min #> Loading required package: SingleCellExperiment #> Loading required package: SummarizedExperiment #> Loading required package: MatrixGenerics #> Loading required package: matrixStats #>  #> Attaching package: 'MatrixGenerics' #> The following objects are masked from 'package:matrixStats': #>  #>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse, #>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums, #>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs, #>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats, #>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds, #>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads, #>     colWeightedMeans, colWeightedMedians, colWeightedSds, #>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet, #>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods, #>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps, #>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins, #>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks, #>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars, #>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians, #>     rowWeightedSds, rowWeightedVars #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: S4Vectors #>  #> Attaching package: 'S4Vectors' #> The following object is masked from 'package:utils': #>  #>     findMatches #> The following objects are masked from 'package:base': #>  #>     expand.grid, I, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb #> Loading required package: Biobase #> Welcome to Bioconductor #>  #>     Vignettes contain introductory material; view with #>     'browseVignettes()'. To cite Bioconductor, see #>     'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'. #>  #> Attaching package: 'Biobase' #> The following object is masked from 'package:MatrixGenerics': #>  #>     rowMedians #> The following objects are masked from 'package:matrixStats': #>  #>     anyMissing, rowMedians library(Matrix) #>  #> Attaching package: 'Matrix' #> The following object is masked from 'package:S4Vectors': #>  #>     expand library(SingleCellExperiment) library(scuttle) library(scater) #> Loading required package: ggplot2 library(scran) library(scRNAseq) library(ggplot2) library(patchwork)  set.seed(427)"},{"path":[]},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"load-and-prepare-data","dir":"Articles","previous_headings":"Basic NMF Workflow","what":"Load and prepare data","title":"Getting Started with NMFscape","text":"’ll use Zeisel brain dataset (Zeisel et al. 2015, Science) contains ~3,000 cells mouse brain diverse cell types including neurons, astrocytes, oligodendrocytes, immune cells. remove mitochondrial genes can dominate gene programs typically reflective technical noise rather biological signals interest.","code":"# Load brain dataset sce <- ZeiselBrainData()  # Remove mitochondrial genes  sce <- sce[!grepl(\"^mt-\", rownames(sce)), ]  # Lognormalize counts sce <- logNormCounts(sce)  # Generate PCA and UMAP for visualization (independent of NMF) sce <- runPCA(sce, ncomponents = 20) sce <- runUMAP(sce, dimred = \"PCA\")"},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"run-nmf","dir":"Articles","previous_headings":"Basic NMF Workflow","what":"Run NMF","title":"Getting Started with NMFscape","text":"run NMF k=10 programs. Choosing k non-trivial chosen care. best practice use cross-validation methods hepl find optimal k dataset (functionaity coming soon). now recommend setting K 10-50 single-cell datasets.","code":"# Run NMF with 10 programs sce <- runNMFscape(sce, k = 10, verbose = FALSE)  # NMF loadings are stored in the reducedDims slot nmf_coords <- reducedDim(sce, \"NMF\") dim(nmf_coords)   #> [1] 3005   10"},{"path":[]},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"plot-nmf-programs-on-umap","dir":"Articles","previous_headings":"Visualizing NMF Results","what":"Plot NMF programs on UMAP","title":"Getting Started with NMFscape","text":"One key uses NMF ability find gene program associated specific cell types /biological states. Cell type-specific program can easily identified plotting program weights within UMAP gene expression space.","code":"# Plot cell type annotations from Zeisel et al. p1 <- plotReducedDim(sce, dimred=\"UMAP\", colour_by=\"level1class\", point_size=0.8) +   ggtitle(\"Zeisel Brain Cell Types\")  # Plot the cell type weights of NMF Program 1 p2 <- vizUMAP(sce, program = 1) +   ggtitle(\"NMF Program 1\")  # Display side by side for comparison p1 + p2"},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"finding-cell-type-specific-programs","dir":"Articles","previous_headings":"Visualizing NMF Results","what":"Finding cell type specific programs","title":"Getting Started with NMFscape","text":"help identify programs associated specific cell types, can use dot plots summarize program usage across annotated cell types.","code":"# dot plot of NMF program weights aggregated with cell types plotProgramDots(sce, group = \"level1class\")"},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"examine-top-weighted-genes-per-program","dir":"Articles","previous_headings":"Visualizing NMF Results","what":"Examine top weighted genes per program","title":"Getting Started with NMFscape","text":"can examine top genes contributing program using heatmap gene weights basis matrix (W). allows us see genes important defining program.  can also compare expression top genes across cell types see NMF programs indeed finding highly specific marker genes distinct cell types.","code":"# Heatmap of top genes per program by weights plotProgramHeatmap(sce, n_genes = 10, cluster_rows=FALSE) library(pheatmap)  # Get the top 10 genes per program top_genes <- getTopFeatures(sce, n = 10)  # Create list of top 5 unique genes across all programs top5_genes <- unique(unlist(lapply(top_genes, function(x) x[1:5])))  # Plot heatmap of top 5 genes across all cell types scater::plotGroupedHeatmap(sce, features = top5_genes,                        group = \"level1class\",                        assay = \"logcounts\",                        scale = TRUE,                        center = TRUE                    )"},{"path":[]},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"differential-program-usage","dir":"Articles","previous_headings":"Finding Differentially Expressed Programs","what":"Differential Program Usage","title":"Getting Started with NMFscape","text":"identify NMF programs enriched specific cell types, can perform differential expression analysis treating program “feature” comparing usage across cell types. FindAllDEPs() function performs 1-vs-comparisons cell type identify programs significantly enriched depleted.","code":"# Find differentially expressed programs across cell types deps <- FindAllDEPs(sce, cell_type_col = \"level1class\")  # View results for pyramidal CA1 neurons head(deps[[\"pyramidal CA1\"]]) #> DataFrame with 6 rows and 12 columns #>       fold_enrichment mean_usage_in mean_usage_out      p.value          FDR #>             <numeric>     <numeric>      <numeric>    <numeric>    <numeric> #> NMF_1      18.1765251   9.49972e-04    5.22637e-05 1.01053e-294 1.01053e-293 #> NMF_4       0.0693575   3.25450e-05    4.69235e-04 5.53198e-265 2.76599e-264 #> NMF_3       0.4775935   1.89939e-04    3.97700e-04 1.82034e-177 6.06779e-177 #> NMF_8       0.1654275   7.44720e-05    4.50179e-04 4.33829e-170 1.08457e-169 #> NMF_5       0.4628984   1.85110e-04    3.99894e-04 1.96935e-146 3.93870e-146 #> NMF_7       0.1611845   7.26923e-05    4.50988e-04 1.79161e-127 2.98602e-127 #>       summary.AUC AUC.astrocytes_ependymal AUC.endothelial-mural #>         <numeric>                <numeric>             <numeric> #> NMF_1  0.99817852                 0.996643             0.9985725 #> NMF_4  0.03001766                 0.292798             0.3283348 #> NMF_3  0.00911491                 0.729732             0.6680579 #> NMF_8  0.11966155                 0.388906             0.4988014 #> NMF_5  0.00203812                 0.578329             0.6556205 #> NMF_7  0.00547210                 0.354571             0.0054721 #>       AUC.interneurons AUC.microglia AUC.oligodendrocytes AUC.pyramidal SS #>              <numeric>     <numeric>            <numeric>        <numeric> #> NMF_1       0.99711358      0.998326            0.9981785       0.99163377 #> NMF_4       0.47739708      0.347124            0.0300177       0.39314474 #> NMF_3       0.51464507      0.689694            0.7290527       0.00911491 #> NMF_8       0.55753369      0.447882            0.1196615       0.43640518 #> NMF_5       0.00203812      0.632832            0.6523650       0.45692906 #> NMF_7       0.46045132      0.254412            0.3767156       0.43647858"},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"visualizing-differential-program-usage","dir":"Articles","previous_headings":"Finding Differentially Expressed Programs","what":"Visualizing Differential Program Usage","title":"Getting Started with NMFscape","text":"can visualize results using volcano plots via plotDEPsVolcano function, show relationship fold enrichment statistical significance. noted p-values inflated -interpreted.  can also summarize differential program usage across cell types using heatmap via plotDEPsHeatmap function make visualization easy. can set logFC_threshold parameter (2 default) highlight programs strong cell type-specificity.","code":"# Volcano plots for all cell types plotDEPsVolcano(deps, fold_threshold = 1.5, pval_threshold = 0.05) # Heatmap of log2 fold change with stars for significant enrichments plotDEPsHeatmap(deps, logfc_threshold = 2, star_size=14)"},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"downstream-analyses","dir":"Articles","previous_headings":"Finding Differentially Expressed Programs","what":"Downstream analyses","title":"Getting Started with NMFscape","text":"NMF programs can used variety downstream analyses including (vingettes coming soon): Integration spatial data: Map NMF programs onto spatial transcriptomics data predict location distinct cell type. Identification disease-associated gene programs: Compare NMF programs healthy diseased samples (case vs control) identify programs associated disease states. Functional enrichment: Perform GO pathway enrichment analysis top genes program identify biological processes represented program. particularly useful case-control experiments disease studies.","code":""},{"path":"https://mictott.github.io/NMFscape/articles/NMFscape.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Getting Started with NMFscape","text":"","code":"sessionInfo() #> R version 4.4.3 Patched (2025-02-28 r87922) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/New_York #> tzcode source: internal #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] pheatmap_1.0.12             patchwork_1.3.0             #>  [3] scRNAseq_2.20.0             scran_1.34.0                #>  [5] scater_1.34.1               ggplot2_3.5.2               #>  [7] scuttle_1.16.0              Matrix_1.7-3                #>  [9] NMFscape_0.99.0             SingleCellExperiment_1.28.1 #> [11] SummarizedExperiment_1.36.0 Biobase_2.66.0              #> [13] GenomicRanges_1.58.0        GenomeInfoDb_1.42.3         #> [15] IRanges_2.40.1              S4Vectors_0.44.0            #> [17] MatrixGenerics_1.18.1       matrixStats_1.5.0           #> [19] BiocGenerics_0.52.0         BiocStyle_2.34.0            #>  #> loaded via a namespace (and not attached): #>   [1] BiocIO_1.16.0            bitops_1.0-9             filelock_1.0.3           #>   [4] tibble_3.2.1             XML_3.99-0.18            lifecycle_1.0.4          #>   [7] httr2_1.1.1              edgeR_4.4.2              lattice_0.22-6           #>  [10] pals_1.10                ensembldb_2.30.0         alabaster.base_1.6.1     #>  [13] magrittr_2.0.3           limma_3.62.2             sass_0.4.9               #>  [16] rmarkdown_2.29           jquerylib_0.1.4          yaml_2.3.12              #>  [19] metapod_1.14.0           otel_0.2.0               cowplot_1.1.3            #>  [22] mapproj_1.2.12           DBI_1.2.3                RColorBrewer_1.1-3       #>  [25] maps_3.4.2.1             abind_1.4-8              zlibbioc_1.52.0          #>  [28] AnnotationFilter_1.30.0  RCurl_1.98-1.17          rappdirs_0.3.3           #>  [31] GenomeInfoDbData_1.2.13  ggrepel_0.9.6            irlba_2.3.5.1            #>  [34] alabaster.sce_1.6.0      dqrng_0.4.1              pkgdown_2.1.3            #>  [37] codetools_0.2-20         DelayedArray_0.32.0      tidyselect_1.2.1         #>  [40] UCSC.utils_1.2.0         farver_2.1.2             ScaledMatrix_1.14.0      #>  [43] viridis_0.6.5            BiocFileCache_2.14.0     GenomicAlignments_1.42.0 #>  [46] jsonlite_1.9.1           BiocNeighbors_2.0.1      systemfonts_1.2.1        #>  [49] tools_4.4.3              ragg_1.5.0               Rcpp_1.1.0               #>  [52] glue_1.8.0               gridExtra_2.3            SparseArray_1.6.2        #>  [55] xfun_0.55                dplyr_1.1.4              HDF5Array_1.34.0         #>  [58] gypsum_1.2.0             withr_3.0.2              BiocManager_1.30.25      #>  [61] fastmap_1.2.0            rhdf5filters_1.18.1      bluster_1.16.0           #>  [64] RcppML_0.3.7             digest_0.6.37            rsvd_1.0.5               #>  [67] R6_2.6.1                 colorspace_2.1-1         textshaping_1.0.0        #>  [70] dichromat_2.0-0.1        RSQLite_2.3.9            generics_0.1.3           #>  [73] rtracklayer_1.66.0       FNN_1.1.4.1              httr_1.4.7               #>  [76] htmlwidgets_1.6.4        S4Arrays_1.6.0           uwot_0.2.3               #>  [79] pkgconfig_2.0.3          gtable_0.3.6             blob_1.2.4               #>  [82] XVector_0.46.0           htmltools_0.5.8.1        bookdown_0.42            #>  [85] ProtGenerics_1.38.0      scales_1.4.0             alabaster.matrix_1.6.1   #>  [88] png_0.1-8                SpatialExperiment_1.16.0 knitr_1.51               #>  [91] rstudioapi_0.17.1        rjson_0.2.23             curl_6.2.1               #>  [94] cachem_1.1.0             rhdf5_2.50.2             BiocVersion_3.20.0       #>  [97] parallel_4.4.3           vipor_0.4.7              AnnotationDbi_1.68.0     #> [100] restfulr_0.0.15          desc_1.4.3               pillar_1.10.1            #> [103] grid_4.4.3               alabaster.schemas_1.6.0  vctrs_0.6.5              #> [106] BiocSingular_1.22.0      dbplyr_2.5.0             beachmat_2.22.0          #> [109] cluster_2.1.8.1          beeswarm_0.4.0           evaluate_1.0.5           #> [112] GenomicFeatures_1.58.0   magick_2.8.5             cli_3.6.5                #> [115] locfit_1.5-9.12          compiler_4.4.3           Rsamtools_2.22.0         #> [118] rlang_1.1.6              crayon_1.5.3             labeling_0.4.3           #> [121] fs_1.6.5                 ggbeeswarm_0.7.2         viridisLite_0.4.2        #> [124] alabaster.se_1.6.0       BiocParallel_1.40.0      Biostrings_2.74.1        #> [127] lazyeval_0.2.2           ExperimentHub_2.14.0     bit64_4.6.0-1            #> [130] Rhdf5lib_1.28.0          KEGGREST_1.46.0          statmod_1.5.0            #> [133] alabaster.ranges_1.6.0   AnnotationHub_3.14.0     igraph_2.1.4             #> [136] memoise_2.0.1            bslib_0.9.0              bit_4.6.0"},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with NMFscape","text":"NMFscape provides fast, scalable non-negative matrix factorization (NMF) single-cell spatial transcriptomic data. NMF decomposes gene expression data biologically interpretable gene expression programs (also called “factors” “metagenes”) weighted patterns across cells.","code":""},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"what-is-nmf","dir":"Articles","previous_headings":"Introduction","what":"What is NMF?","title":"Getting Started with NMFscape","text":"Non-negative matrix factorization decomposes gene expression matrix X (genes × cells) two lower-rank matrices: W (genes × k programs): Gene loadings - genes contribute program H (k programs × cells): Cell loadings - much cell uses program key constraint values W H non-negative (≥0), enforces “parts-based” representation programs combine additively. particularly suited biological data gene expression counts inherently non-negative.","code":""},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"why-nmf-for-single-cell-analysis","dir":"Articles","previous_headings":"Introduction","what":"Why NMF for single-cell analysis?","title":"Getting Started with NMFscape","text":"Gene program decomposition: Identifies gene modules work together biological processes Cell type discovery: Programs often correspond cell type-specific signatures, cell states, biological pathways Biologically interpretable: Gene programs represent co-expressed gene modules can used downstream functional enrichment pathway analysis NMFscape uses RcppML high-performance computation integrates seamlessly Bioconductor workflows, storing results directly SingleCellExperiment SpatialExperiment objects.","code":"library(NMFscape) #> Loading required package: BiocGenerics #>  #> Attaching package: 'BiocGenerics' #> The following objects are masked from 'package:stats': #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from 'package:base': #>  #>     anyDuplicated, aperm, append, as.data.frame, basename, cbind, #>     colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find, #>     get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply, #>     match, mget, order, paste, pmax, pmax.int, pmin, pmin.int, #>     Position, rank, rbind, Reduce, rownames, sapply, saveRDS, setdiff, #>     table, tapply, union, unique, unsplit, which.max, which.min #> Loading required package: SingleCellExperiment #> Loading required package: SummarizedExperiment #> Loading required package: MatrixGenerics #> Loading required package: matrixStats #>  #> Attaching package: 'MatrixGenerics' #> The following objects are masked from 'package:matrixStats': #>  #>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse, #>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums, #>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs, #>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats, #>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds, #>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads, #>     colWeightedMeans, colWeightedMedians, colWeightedSds, #>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet, #>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods, #>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps, #>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins, #>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks, #>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars, #>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians, #>     rowWeightedSds, rowWeightedVars #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: S4Vectors #>  #> Attaching package: 'S4Vectors' #> The following object is masked from 'package:utils': #>  #>     findMatches #> The following objects are masked from 'package:base': #>  #>     expand.grid, I, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb #> Loading required package: Biobase #> Welcome to Bioconductor #>  #>     Vignettes contain introductory material; view with #>     'browseVignettes()'. To cite Bioconductor, see #>     'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'. #>  #> Attaching package: 'Biobase' #> The following object is masked from 'package:MatrixGenerics': #>  #>     rowMedians #> The following objects are masked from 'package:matrixStats': #>  #>     anyMissing, rowMedians library(Matrix) #>  #> Attaching package: 'Matrix' #> The following object is masked from 'package:S4Vectors': #>  #>     expand library(SingleCellExperiment) library(scuttle) library(scater) #> Loading required package: ggplot2 library(scran) library(scRNAseq) library(ggplot2) library(patchwork)  set.seed(427)"},{"path":[]},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"load-and-prepare-data","dir":"Articles","previous_headings":"Basic NMF Workflow","what":"Load and prepare data","title":"Getting Started with NMFscape","text":"’ll use Zeisel brain dataset (Zeisel et al. 2015, Science) contains ~3,000 cells mouse brain diverse cell types including neurons, astrocytes, oligodendrocytes, immune cells. remove mitochondrial genes can dominate gene programs typically reflective technical noise rather biological signals interest.","code":"# Load brain dataset sce <- ZeiselBrainData()  # Remove mitochondrial genes  sce <- sce[!grepl(\"^mt-\", rownames(sce)), ]  # Lognormalize counts sce <- logNormCounts(sce)  # Generate PCA and UMAP for visualization (independent of NMF) sce <- runPCA(sce, ncomponents = 20) sce <- runUMAP(sce, dimred = \"PCA\")"},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"run-nmf","dir":"Articles","previous_headings":"Basic NMF Workflow","what":"Run NMF","title":"Getting Started with NMFscape","text":"run NMF k=10 programs. Choosing k non-trivial chosen care. best practice use cross-validation methods hepl find optimal k dataset (functionaity coming soon). now recommend setting K 10-50 single-cell datasets.","code":"# Run NMF with 10 programs sce <- runNMFscape(sce, k = 10, verbose = FALSE)  # NMF loadings are stored in the reducedDims slot nmf_coords <- reducedDim(sce, \"NMF\") dim(nmf_coords)   #> [1] 3005   10"},{"path":[]},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"plot-nmf-programs-on-umap","dir":"Articles","previous_headings":"Visualizing NMF Results","what":"Plot NMF programs on UMAP","title":"Getting Started with NMFscape","text":"One key uses NMF ability find gene program associated specific cell types /biological states. Cell type-specific program can easily identified plotting program weights within UMAP gene expression space.","code":"# Plot cell type annotations from Zeisel et al. p1 <- plotReducedDim(sce, dimred=\"UMAP\", colour_by=\"level1class\", point_size=0.8) +   ggtitle(\"Zeisel Brain Cell Types\")  # Plot the cell type weights of NMF Program 1 p2 <- vizUMAP(sce, program = 1) +   ggtitle(\"NMF Program 1\")  # Display side by side for comparison p1 + p2"},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"finding-cell-type-specific-programs","dir":"Articles","previous_headings":"Visualizing NMF Results","what":"Finding cell type specific programs","title":"Getting Started with NMFscape","text":"help identify programs associated specific cell types, can use dot plots summarize program usage across annotated cell types.","code":"# dot plot of NMF program weights aggregated with cell types plotProgramDots(sce, group = \"level1class\")"},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"examine-top-weighted-genes-per-program","dir":"Articles","previous_headings":"Visualizing NMF Results","what":"Examine top weighted genes per program","title":"Getting Started with NMFscape","text":"can examine top genes contributing program using heatmap gene weights basis matrix (W). allows us see genes important defining program.  can also compare expression top genes across cell types see NMF programs indeed finding highly specific marker genes distinct cell types.","code":"# Heatmap of top genes per program by weights plotProgramHeatmap(sce, n_genes = 10, cluster_rows=FALSE) library(pheatmap)  # Get the top 10 genes per program top_genes <- getTopFeatures(sce, n = 10)  # Create list of top 5 unique genes across all programs top5_genes <- unique(unlist(lapply(top_genes, function(x) x[1:5])))  # Plot heatmap of top 5 genes across all cell types scater::plotGroupedHeatmap(sce, features = top5_genes,                        group = \"level1class\",                        assay = \"logcounts\",                        scale = TRUE,                        center = TRUE                    )"},{"path":[]},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"differential-program-usage","dir":"Articles","previous_headings":"Finding Differentially Expressed Programs","what":"Differential Program Usage","title":"Getting Started with NMFscape","text":"identify NMF programs enriched specific cell types, can perform differential expression analysis treating program “feature” comparing usage across cell types. FindAllDEPs() function performs 1-vs-comparisons cell type identify programs significantly enriched depleted.","code":"# Find differentially expressed programs across cell types deps <- FindAllDEPs(sce, cell_type_col = \"level1class\")  # View results for pyramidal CA1 neurons head(deps[[\"pyramidal CA1\"]]) #> DataFrame with 6 rows and 12 columns #>       fold_enrichment mean_usage_in mean_usage_out      p.value          FDR #>             <numeric>     <numeric>      <numeric>    <numeric>    <numeric> #> NMF_1      18.1765251   9.49972e-04    5.22637e-05 1.01053e-294 1.01053e-293 #> NMF_4       0.0693575   3.25450e-05    4.69235e-04 5.53198e-265 2.76599e-264 #> NMF_3       0.4775935   1.89939e-04    3.97700e-04 1.82034e-177 6.06779e-177 #> NMF_8       0.1654275   7.44720e-05    4.50179e-04 4.33829e-170 1.08457e-169 #> NMF_5       0.4628984   1.85110e-04    3.99894e-04 1.96935e-146 3.93870e-146 #> NMF_7       0.1611845   7.26923e-05    4.50988e-04 1.79161e-127 2.98602e-127 #>       summary.AUC AUC.astrocytes_ependymal AUC.endothelial-mural #>         <numeric>                <numeric>             <numeric> #> NMF_1  0.99817852                 0.996643             0.9985725 #> NMF_4  0.03001766                 0.292798             0.3283348 #> NMF_3  0.00911491                 0.729732             0.6680579 #> NMF_8  0.11966155                 0.388906             0.4988014 #> NMF_5  0.00203812                 0.578329             0.6556205 #> NMF_7  0.00547210                 0.354571             0.0054721 #>       AUC.interneurons AUC.microglia AUC.oligodendrocytes AUC.pyramidal SS #>              <numeric>     <numeric>            <numeric>        <numeric> #> NMF_1       0.99711358      0.998326            0.9981785       0.99163377 #> NMF_4       0.47739708      0.347124            0.0300177       0.39314474 #> NMF_3       0.51464507      0.689694            0.7290527       0.00911491 #> NMF_8       0.55753369      0.447882            0.1196615       0.43640518 #> NMF_5       0.00203812      0.632832            0.6523650       0.45692906 #> NMF_7       0.46045132      0.254412            0.3767156       0.43647858"},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"visualizing-differential-program-usage","dir":"Articles","previous_headings":"Finding Differentially Expressed Programs","what":"Visualizing Differential Program Usage","title":"Getting Started with NMFscape","text":"can visualize results using volcano plots via plotDEPsVolcano function, show relationship fold enrichment statistical significance. noted p-values inflated -interpreted.  can also summarize differential program usage across cell types using heatmap via plotDEPsHeatmap function make visualization easy. can set logFC_threshold parameter (2 default) highlight programs strong cell type-specificity.","code":"# Volcano plots for all cell types plotDEPsVolcano(deps, fold_threshold = 1.5, pval_threshold = 0.05) # Heatmap of log2 fold change with stars for significant enrichments plotDEPsHeatmap(deps, logfc_threshold = 2, star_size=14)"},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"downstream-analyses","dir":"Articles","previous_headings":"Finding Differentially Expressed Programs","what":"Downstream analyses","title":"Getting Started with NMFscape","text":"NMF programs can used variety downstream analyses including (vingettes coming soon): Integration spatial data: Map NMF programs onto spatial transcriptomics data predict location distinct cell type. Identification disease-associated gene programs: Compare NMF programs healthy diseased samples (case vs control) identify programs associated disease states. Functional enrichment: Perform GO pathway enrichment analysis top genes program identify biological processes represented program. particularly useful case-control experiments disease studies.","code":""},{"path":"https://mictott.github.io/NMFscape/articles/getting-started.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Getting Started with NMFscape","text":"","code":"sessionInfo() #> R version 4.4.3 Patched (2025-02-28 r87922) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/New_York #> tzcode source: internal #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] pheatmap_1.0.12             patchwork_1.3.0             #>  [3] scRNAseq_2.20.0             scran_1.34.0                #>  [5] scater_1.34.1               ggplot2_3.5.2               #>  [7] scuttle_1.16.0              Matrix_1.7-3                #>  [9] NMFscape_0.99.0             SingleCellExperiment_1.28.1 #> [11] SummarizedExperiment_1.36.0 Biobase_2.66.0              #> [13] GenomicRanges_1.58.0        GenomeInfoDb_1.42.3         #> [15] IRanges_2.40.1              S4Vectors_0.44.0            #> [17] MatrixGenerics_1.18.1       matrixStats_1.5.0           #> [19] BiocGenerics_0.52.0         BiocStyle_2.34.0            #>  #> loaded via a namespace (and not attached): #>   [1] BiocIO_1.16.0            bitops_1.0-9             filelock_1.0.3           #>   [4] tibble_3.2.1             XML_3.99-0.18            lifecycle_1.0.4          #>   [7] httr2_1.1.1              edgeR_4.4.2              lattice_0.22-6           #>  [10] pals_1.10                ensembldb_2.30.0         alabaster.base_1.6.1     #>  [13] magrittr_2.0.3           limma_3.62.2             sass_0.4.9               #>  [16] rmarkdown_2.29           jquerylib_0.1.4          yaml_2.3.12              #>  [19] metapod_1.14.0           otel_0.2.0               cowplot_1.1.3            #>  [22] mapproj_1.2.12           DBI_1.2.3                RColorBrewer_1.1-3       #>  [25] maps_3.4.2.1             abind_1.4-8              zlibbioc_1.52.0          #>  [28] AnnotationFilter_1.30.0  RCurl_1.98-1.17          rappdirs_0.3.3           #>  [31] GenomeInfoDbData_1.2.13  ggrepel_0.9.6            irlba_2.3.5.1            #>  [34] alabaster.sce_1.6.0      dqrng_0.4.1              pkgdown_2.1.3            #>  [37] codetools_0.2-20         DelayedArray_0.32.0      tidyselect_1.2.1         #>  [40] UCSC.utils_1.2.0         farver_2.1.2             ScaledMatrix_1.14.0      #>  [43] viridis_0.6.5            BiocFileCache_2.14.0     GenomicAlignments_1.42.0 #>  [46] jsonlite_1.9.1           BiocNeighbors_2.0.1      systemfonts_1.2.1        #>  [49] tools_4.4.3              ragg_1.5.0               Rcpp_1.1.0               #>  [52] glue_1.8.0               gridExtra_2.3            SparseArray_1.6.2        #>  [55] xfun_0.55                dplyr_1.1.4              HDF5Array_1.34.0         #>  [58] gypsum_1.2.0             withr_3.0.2              BiocManager_1.30.25      #>  [61] fastmap_1.2.0            rhdf5filters_1.18.1      bluster_1.16.0           #>  [64] RcppML_0.3.7             digest_0.6.37            rsvd_1.0.5               #>  [67] R6_2.6.1                 colorspace_2.1-1         textshaping_1.0.0        #>  [70] dichromat_2.0-0.1        RSQLite_2.3.9            generics_0.1.3           #>  [73] rtracklayer_1.66.0       FNN_1.1.4.1              httr_1.4.7               #>  [76] htmlwidgets_1.6.4        S4Arrays_1.6.0           uwot_0.2.3               #>  [79] pkgconfig_2.0.3          gtable_0.3.6             blob_1.2.4               #>  [82] XVector_0.46.0           htmltools_0.5.8.1        bookdown_0.42            #>  [85] ProtGenerics_1.38.0      scales_1.4.0             alabaster.matrix_1.6.1   #>  [88] png_0.1-8                SpatialExperiment_1.16.0 knitr_1.51               #>  [91] rstudioapi_0.17.1        rjson_0.2.23             curl_6.2.1               #>  [94] cachem_1.1.0             rhdf5_2.50.2             BiocVersion_3.20.0       #>  [97] parallel_4.4.3           vipor_0.4.7              AnnotationDbi_1.68.0     #> [100] restfulr_0.0.15          desc_1.4.3               pillar_1.10.1            #> [103] grid_4.4.3               alabaster.schemas_1.6.0  vctrs_0.6.5              #> [106] BiocSingular_1.22.0      dbplyr_2.5.0             beachmat_2.22.0          #> [109] cluster_2.1.8.1          beeswarm_0.4.0           evaluate_1.0.5           #> [112] GenomicFeatures_1.58.0   magick_2.8.5             cli_3.6.5                #> [115] locfit_1.5-9.12          compiler_4.4.3           Rsamtools_2.22.0         #> [118] rlang_1.1.6              crayon_1.5.3             labeling_0.4.3           #> [121] fs_1.6.5                 ggbeeswarm_0.7.2         viridisLite_0.4.2        #> [124] alabaster.se_1.6.0       BiocParallel_1.40.0      Biostrings_2.74.1        #> [127] lazyeval_0.2.2           ExperimentHub_2.14.0     bit64_4.6.0-1            #> [130] Rhdf5lib_1.28.0          KEGGREST_1.46.0          statmod_1.5.0            #> [133] alabaster.ranges_1.6.0   AnnotationHub_3.14.0     igraph_2.1.4             #> [136] memoise_2.0.1            bslib_0.9.0              bit_4.6.0"},{"path":"https://mictott.github.io/NMFscape/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Totty. Author, maintainer.","code":""},{"path":"https://mictott.github.io/NMFscape/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Totty M (2026). NMFscape: Fast Non-negative Matrix Factorization Single Cell Spatial Data. R package version 0.99.0, https://mictott.github.io/NMFscape/, https://github.com/MicTott/NMFscape.","code":"@Manual{,   title = {NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data},   author = {Michael Totty},   year = {2026},   note = {R package version 0.99.0, https://mictott.github.io/NMFscape/},   url = {https://github.com/MicTott/NMFscape}, }"},{"path":"https://mictott.github.io/NMFscape/index.html","id":"nmfscape-","dir":"","previous_headings":"","what":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data","title":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data","text":"Fast Non-negative Matrix Factorization Single Cell Spatial Data using RcppML","code":""},{"path":"https://mictott.github.io/NMFscape/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data","text":"NMFscape provides high-performance non-negative matrix factorization (NMF) methods SingleCellExperiment SpatialExperiment objects. package features: Fast NMF: Uses RcppML backend high-performance matrix factorization Bioconductor Integration: Seamless workflow SingleCellExperiment SpatialExperiment objects Visualization Tools: Comprehensive plotting functions downstream analysis Cell Type Analysis: Differential program analysis cell type mapping","code":""},{"path":[]},{"path":"https://mictott.github.io/NMFscape/index.html","id":"core-nmf-functions","dir":"","previous_headings":"Features","what":"Core NMF Functions","title":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data","text":"runNMFscape() - Fast NMF using RcppML backend Results stored reducedDims() basis metadata()","code":""},{"path":"https://mictott.github.io/NMFscape/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data","text":"","code":"# Install from GitHub if (!requireNamespace(\"devtools\", quietly = TRUE))     install.packages(\"devtools\") devtools::install_github(\"MicTott/NMFscape\")  # Load package library(NMFscape)"},{"path":"https://mictott.github.io/NMFscape/index.html","id":"requirements","dir":"","previous_headings":"","what":"Requirements","title":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data","text":"R (>= 4.3.0) Bioconductor packages: SingleCellExperiment, SummarizedExperiment RcppML fast NMF computation (CRAN v0.3.7) ggplot2 visualization (suggested)","code":""},{"path":"https://mictott.github.io/NMFscape/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data","text":"use NMFscape research, please cite: RcppML: DeBruine et al. (2021) “High-performance non-negative matrix factorization large single cell data”","code":""},{"path":"https://mictott.github.io/NMFscape/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data","text":"package licensed Artistic-2.0 license.","code":""},{"path":"https://mictott.github.io/NMFscape/index.html","id":"issues","dir":"","previous_headings":"","what":"Issues","title":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data","text":"Please report issues GitHub Issues.","code":""},{"path":"https://mictott.github.io/NMFscape/reference/BiocNMF-package.html","id":null,"dir":"Reference","previous_headings":"","what":"BiocNMF: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data — BiocNMF-package","title":"BiocNMF: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data — BiocNMF-package","text":"package provides high-performance non-negative matrix factorization (NMF) methods SingleCellExperiment SpatialExperiment objects using RcppML backend. enables efficient dimensionality reduction, feature extraction, pattern discovery single-cell spatial genomics data, seamless integration Bioconductor workflows.","code":""},{"path":[]},{"path":"https://mictott.github.io/NMFscape/reference/BiocNMF-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"BiocNMF: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data — BiocNMF-package","text":"Maintainer: Michael Totty mictott@gmail.com","code":""},{"path":"https://mictott.github.io/NMFscape/reference/FindAllDEPs.html","id":null,"dir":"Reference","previous_headings":"","what":"Find All Differentially Expressed Programs (1-vs-all analysis) — FindAllDEPs","title":"Find All Differentially Expressed Programs (1-vs-all analysis) — FindAllDEPs","text":"Uses scran::findMarkers identify NMF programs differentially expressed cell type compared cell types. Treats NMF program \"gene\" performs 1-vs-comparisons.","code":""},{"path":"https://mictott.github.io/NMFscape/reference/FindAllDEPs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find All Differentially Expressed Programs (1-vs-all analysis) — FindAllDEPs","text":"","code":"FindAllDEPs(   x,   cell_type_col,   nmf_name = \"NMF\",   test = \"wilcox\",   pval.type = \"some\",   log.p = FALSE,   min.prop = 0.1 )"},{"path":"https://mictott.github.io/NMFscape/reference/FindAllDEPs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find All Differentially Expressed Programs (1-vs-all analysis) — FindAllDEPs","text":"x SingleCellExperiment object NMF results cell_type_col Character, column name colData containing cell type labels nmf_name Character, name NMF result use (default \"NMF\") test Character, statistical test use: \"wilcox\" (default), \"t\", \"binom\" pval.type Character, p-value type: \"\", \"\", \"\" (default \"\") log.p Logical, whether log-transform p-values (default FALSE) min.prop Numeric, minimum proportion cells must express program (default 0.1)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/FindAllDEPs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find All Differentially Expressed Programs (1-vs-all analysis) — FindAllDEPs","text":"List DataFrames (one per cell type) differential expression statistics","code":""},{"path":"https://mictott.github.io/NMFscape/reference/FindAllDEPs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find All Differentially Expressed Programs (1-vs-all analysis) — FindAllDEPs","text":"","code":"library(scuttle) sce <- mockSCE(ngenes = 100, ncells = 50) sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 3, verbose = FALSE) sce$celltype <- sample(c(\"A\", \"B\"), ncol(sce), replace = TRUE) deps <- FindAllDEPs(sce, cell_type_col = \"celltype\") head(deps[[1]]) #> DataFrame with 3 rows and 7 columns #>       fold_enrichment mean_usage_in mean_usage_out   p.value       FDR #>             <numeric>     <numeric>      <numeric> <numeric> <numeric> #> NMF_1        0.911756     0.0190768      0.0209232  0.891912  0.969038 #> NMF_2        1.102998     0.0209795      0.0190205  0.915013  0.969038 #> NMF_3        0.983386     0.0198325      0.0201675  0.969038  0.969038 #>       summary.AUC     AUC.B #>         <numeric> <numeric> #> NMF_1      0.4880    0.4880 #> NMF_2      0.5096    0.5096 #> NMF_3      0.4960    0.4960"},{"path":"https://mictott.github.io/NMFscape/reference/NMFscape-package.html","id":null,"dir":"Reference","previous_headings":"","what":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data — NMFscape-package","title":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data — NMFscape-package","text":"package provides high-performance non-negative matrix factorization (NMF) methods SingleCellExperiment SpatialExperiment objects using RcppML backend. enables efficient dimensionality reduction, feature extraction, pattern discovery single-cell spatial genomics data, seamless integration Bioconductor workflows.","code":""},{"path":[]},{"path":"https://mictott.github.io/NMFscape/reference/NMFscape-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"NMFscape: Fast Non-negative Matrix Factorization for Single Cell and Spatial Data — NMFscape-package","text":"Maintainer: Michael Totty mictott@gmail.com","code":""},{"path":"https://mictott.github.io/NMFscape/reference/applyDensityFiltering.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply density filtering to remove outlier spectra — applyDensityFiltering","title":"Apply density filtering to remove outlier spectra — applyDensityFiltering","text":"implements local density filtering similar original cNMF","code":""},{"path":"https://mictott.github.io/NMFscape/reference/applyDensityFiltering.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply density filtering to remove outlier spectra — applyDensityFiltering","text":"","code":"applyDensityFiltering(spectra_matrix, density_threshold = 0.5)"},{"path":"https://mictott.github.io/NMFscape/reference/applyDensityFiltering.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply density filtering to remove outlier spectra — applyDensityFiltering","text":"spectra_matrix Matrix spectra (rows = spectra, cols = features) density_threshold Numeric, threshold density filtering","code":""},{"path":"https://mictott.github.io/NMFscape/reference/applyDensityFiltering.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply density filtering to remove outlier spectra — applyDensityFiltering","text":"List valid indices density scores","code":""},{"path":"https://mictott.github.io/NMFscape/reference/buildConsensusMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Build consensus matrix showing co-clustering frequency — buildConsensusMatrix","title":"Build consensus matrix showing co-clustering frequency — buildConsensusMatrix","text":"Build consensus matrix showing co-clustering frequency","code":""},{"path":"https://mictott.github.io/NMFscape/reference/buildConsensusMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build consensus matrix showing co-clustering frequency — buildConsensusMatrix","text":"","code":"buildConsensusMatrix(valid_indices, cluster_assignments, n_total_spectra)"},{"path":"https://mictott.github.io/NMFscape/reference/buildConsensusMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build consensus matrix showing co-clustering frequency — buildConsensusMatrix","text":"valid_indices Indices spectra passed filtering cluster_assignments Cluster assignments filtered spectra n_total_spectra Total number spectra filtering","code":""},{"path":"https://mictott.github.io/NMFscape/reference/buildConsensusMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build consensus matrix showing co-clustering frequency — buildConsensusMatrix","text":"Matrix showing co-clustering frequency","code":""},{"path":"https://mictott.github.io/NMFscape/reference/calculateConsensusMatrices.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate consensus matrices using clustering approach (true cNMF) — calculateConsensusMatrices","title":"Calculate consensus matrices using clustering approach (true cNMF) — calculateConsensusMatrices","text":"implements proper consensus clustering approach Kotliar et al. gene expression programs multiple runs clustered rather averaged.","code":""},{"path":"https://mictott.github.io/NMFscape/reference/calculateConsensusMatrices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate consensus matrices using clustering approach (true cNMF) — calculateConsensusMatrices","text":"","code":"calculateConsensusMatrices(   nmf_runs,   k,   feature_names,   sample_names,   density_threshold = 0.5,   max_iter = 1000 )"},{"path":"https://mictott.github.io/NMFscape/reference/calculateConsensusMatrices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate consensus matrices using clustering approach (true cNMF) — calculateConsensusMatrices","text":"nmf_runs List NMF results RcppML::nmf k Integer, number factors feature_names Character vector feature names sample_names Character vector sample names density_threshold Numeric, threshold density filtering (default 0.5) max_iter Integer, maximum iterations k-means (default 1000)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/calculateConsensusMatrices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate consensus matrices using clustering approach (true cNMF) — calculateConsensusMatrices","text":"List containing consensus matrices clustering information","code":""},{"path":"https://mictott.github.io/NMFscape/reference/calculateCopheneticCorrelation.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate cophenetic correlation for clustering quality assessment — calculateCopheneticCorrelation","title":"Calculate cophenetic correlation for clustering quality assessment — calculateCopheneticCorrelation","text":"Calculate cophenetic correlation clustering quality assessment","code":""},{"path":"https://mictott.github.io/NMFscape/reference/calculateCopheneticCorrelation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate cophenetic correlation for clustering quality assessment — calculateCopheneticCorrelation","text":"","code":"calculateCopheneticCorrelation(consensus_matrix)"},{"path":"https://mictott.github.io/NMFscape/reference/calculateCopheneticCorrelation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate cophenetic correlation for clustering quality assessment — calculateCopheneticCorrelation","text":"consensus_matrix Consensus matrix showing co-clustering frequencies","code":""},{"path":"https://mictott.github.io/NMFscape/reference/calculateCopheneticCorrelation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate cophenetic correlation for clustering quality assessment — calculateCopheneticCorrelation","text":"Cophenetic correlation coefficient","code":""},{"path":"https://mictott.github.io/NMFscape/reference/calculateStabilityMetrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate stability metrics for consensus NMF using clustering approach — calculateStabilityMetrics","title":"Calculate stability metrics for consensus NMF using clustering approach — calculateStabilityMetrics","text":"Calculate stability metrics consensus NMF using clustering approach","code":""},{"path":"https://mictott.github.io/NMFscape/reference/calculateStabilityMetrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate stability metrics for consensus NMF using clustering approach — calculateStabilityMetrics","text":"","code":"calculateStabilityMetrics(nmf_runs, consensus_result)"},{"path":"https://mictott.github.io/NMFscape/reference/calculateStabilityMetrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate stability metrics for consensus NMF using clustering approach — calculateStabilityMetrics","text":"nmf_runs List NMF results consensus_result List consensus matrices clustering info","code":""},{"path":"https://mictott.github.io/NMFscape/reference/calculateStabilityMetrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate stability metrics for consensus NMF using clustering approach — calculateStabilityMetrics","text":"List stability metrics","code":""},{"path":"https://mictott.github.io/NMFscape/reference/cosine_distance.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate cosine distance between vectors — cosine_distance","title":"Calculate cosine distance between vectors — cosine_distance","text":"Calculate cosine distance vectors","code":""},{"path":"https://mictott.github.io/NMFscape/reference/cosine_distance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate cosine distance between vectors — cosine_distance","text":"","code":"cosine_distance(x, y)"},{"path":"https://mictott.github.io/NMFscape/reference/cosine_distance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate cosine distance between vectors — cosine_distance","text":"x First vector y Second vector","code":""},{"path":"https://mictott.github.io/NMFscape/reference/cosine_distance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate cosine distance between vectors — cosine_distance","text":"Cosine distance (1 - cosine similarity)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/findBestMatching.html","id":null,"dir":"Reference","previous_headings":"","what":"Find best matching between two factor matrices — findBestMatching","title":"Find best matching between two factor matrices — findBestMatching","text":"Find best matching two factor matrices","code":""},{"path":"https://mictott.github.io/NMFscape/reference/findBestMatching.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find best matching between two factor matrices — findBestMatching","text":"","code":"findBestMatching(mat1, mat2)"},{"path":"https://mictott.github.io/NMFscape/reference/findBestMatching.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find best matching between two factor matrices — findBestMatching","text":"mat1 First matrix mat2 Second matrix","code":""},{"path":"https://mictott.github.io/NMFscape/reference/findBestMatching.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find best matching between two factor matrices — findBestMatching","text":"List permutation correlation matrix","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getAvailableK.html","id":null,"dir":"Reference","previous_headings":"","what":"Get available k values from cNMF results — getAvailableK","title":"Get available k values from cNMF results — getAvailableK","text":"Get available k values cNMF results","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getAvailableK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get available k values from cNMF results — getAvailableK","text":"","code":"getAvailableK(x, name = \"cNMF\")"},{"path":"https://mictott.github.io/NMFscape/reference/getAvailableK.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get available k values from cNMF results — getAvailableK","text":"x SingleCellExperiment object cNMF results name Character, name cNMF result (default \"cNMF\")","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getAvailableK.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get available k values from cNMF results — getAvailableK","text":"Integer vector available k values","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getAvailableK.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get available k values from cNMF results — getAvailableK","text":"","code":"# sce <- runConsensusNMF(sce, k_range = 5:10) # k_values <- getAvailableK(sce)"},{"path":"https://mictott.github.io/NMFscape/reference/getBasis.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract NMF basis matrix from SingleCellExperiment object — getBasis","title":"Extract NMF basis matrix from SingleCellExperiment object — getBasis","text":"Extract NMF basis matrix SingleCellExperiment object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getBasis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract NMF basis matrix from SingleCellExperiment object — getBasis","text":"","code":"getBasis(x, name = \"NMF\")"},{"path":"https://mictott.github.io/NMFscape/reference/getBasis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract NMF basis matrix from SingleCellExperiment object — getBasis","text":"x SingleCellExperiment object NMF results name Character, name NMF result extract (default \"NMF\")","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getBasis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract NMF basis matrix from SingleCellExperiment object — getBasis","text":"Matrix features x factors (basis matrix)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getBasis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract NMF basis matrix from SingleCellExperiment object — getBasis","text":"","code":"library(scuttle) sce <- mockSCE(ngenes = 100, ncells = 50) sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 3, verbose = FALSE) basis <- getBasis(sce) dim(basis) #> [1] 100   3"},{"path":"https://mictott.github.io/NMFscape/reference/getCoefficients.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract NMF coefficient matrix from SingleCellExperiment object — getCoefficients","title":"Extract NMF coefficient matrix from SingleCellExperiment object — getCoefficients","text":"Extract NMF coefficient matrix SingleCellExperiment object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getCoefficients.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract NMF coefficient matrix from SingleCellExperiment object — getCoefficients","text":"","code":"getCoefficients(x, name = \"NMF\")"},{"path":"https://mictott.github.io/NMFscape/reference/getCoefficients.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract NMF coefficient matrix from SingleCellExperiment object — getCoefficients","text":"x SingleCellExperiment object NMF results name Character, name NMF result extract (default \"NMF\")","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getCoefficients.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract NMF coefficient matrix from SingleCellExperiment object — getCoefficients","text":"Matrix cells x factors (coefficient matrix, reducedDim)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getCoefficients.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract NMF coefficient matrix from SingleCellExperiment object — getCoefficients","text":"","code":"library(scuttle) sce <- mockSCE(ngenes = 100, ncells = 50) sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 3, verbose = FALSE) coeffs <- getCoefficients(sce) dim(coeffs) #> [1] 50  3"},{"path":"https://mictott.github.io/NMFscape/reference/getConsensusGEPs.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract consensus gene expression programs (GEPs) from cNMF results — getConsensusGEPs","title":"Extract consensus gene expression programs (GEPs) from cNMF results — getConsensusGEPs","text":"Extract consensus gene expression programs (GEPs) cNMF results","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getConsensusGEPs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract consensus gene expression programs (GEPs) from cNMF results — getConsensusGEPs","text":"","code":"getConsensusGEPs(x, name = \"cNMF\", k = NULL)"},{"path":"https://mictott.github.io/NMFscape/reference/getConsensusGEPs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract consensus gene expression programs (GEPs) from cNMF results — getConsensusGEPs","text":"x SingleCellExperiment object cNMF results name Character, name cNMF result extract (default \"cNMF\") k Integer, k value extract. NULL, uses optimal k","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getConsensusGEPs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract consensus gene expression programs (GEPs) from cNMF results — getConsensusGEPs","text":"Matrix features x programs (consensus basis matrix)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getConsensusGEPs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract consensus gene expression programs (GEPs) from cNMF results — getConsensusGEPs","text":"","code":"# sce <- runConsensusNMF(sce, k_range = 5:10) # geps <- getConsensusGEPs(sce)"},{"path":"https://mictott.github.io/NMFscape/reference/getConsensusNMFInfo.html","id":null,"dir":"Reference","previous_headings":"","what":"Get consensus NMF information and parameters — getConsensusNMFInfo","title":"Get consensus NMF information and parameters — getConsensusNMFInfo","text":"Get consensus NMF information parameters","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getConsensusNMFInfo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get consensus NMF information and parameters — getConsensusNMFInfo","text":"","code":"getConsensusNMFInfo(x, name = \"cNMF\")"},{"path":"https://mictott.github.io/NMFscape/reference/getConsensusNMFInfo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get consensus NMF information and parameters — getConsensusNMFInfo","text":"x SingleCellExperiment object cNMF results name Character, name cNMF result (default \"cNMF\")","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getConsensusNMFInfo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get consensus NMF information and parameters — getConsensusNMFInfo","text":"List cNMF run information (excluding large matrices)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getConsensusNMFInfo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get consensus NMF information and parameters — getConsensusNMFInfo","text":"","code":"# sce <- runConsensusNMF(sce, k_range = 5:10) # info <- getConsensusNMFInfo(sce)"},{"path":"https://mictott.github.io/NMFscape/reference/getGEPUsage.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract GEP usage matrix from cNMF results — getGEPUsage","title":"Extract GEP usage matrix from cNMF results — getGEPUsage","text":"Extract GEP usage matrix cNMF results","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getGEPUsage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract GEP usage matrix from cNMF results — getGEPUsage","text":"","code":"getGEPUsage(x, name = \"cNMF\", k = NULL)"},{"path":"https://mictott.github.io/NMFscape/reference/getGEPUsage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract GEP usage matrix from cNMF results — getGEPUsage","text":"x SingleCellExperiment object cNMF results name Character, name cNMF result extract (default \"cNMF\") k Integer, k value extract. NULL, uses optimal k","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getGEPUsage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract GEP usage matrix from cNMF results — getGEPUsage","text":"Matrix cells x programs (consensus usage matrix)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getGEPUsage.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract GEP usage matrix from cNMF results — getGEPUsage","text":"","code":"# sce <- runConsensusNMF(sce, k_range = 5:10) # usage <- getGEPUsage(sce)"},{"path":"https://mictott.github.io/NMFscape/reference/getOptimalK.html","id":null,"dir":"Reference","previous_headings":"","what":"Get optimal k value from cNMF results — getOptimalK","title":"Get optimal k value from cNMF results — getOptimalK","text":"Get optimal k value cNMF results","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getOptimalK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get optimal k value from cNMF results — getOptimalK","text":"","code":"getOptimalK(x, name = \"cNMF\")"},{"path":"https://mictott.github.io/NMFscape/reference/getOptimalK.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get optimal k value from cNMF results — getOptimalK","text":"x SingleCellExperiment object cNMF results name Character, name cNMF result (default \"cNMF\")","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getOptimalK.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get optimal k value from cNMF results — getOptimalK","text":"Integer, optimal k value","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getOptimalK.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get optimal k value from cNMF results — getOptimalK","text":"","code":"# sce <- runConsensusNMF(sce, k_range = 5:10) # k_opt <- getOptimalK(sce)"},{"path":"https://mictott.github.io/NMFscape/reference/getStabilityMetrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Get stability metrics from cNMF results — getStabilityMetrics","title":"Get stability metrics from cNMF results — getStabilityMetrics","text":"Get stability metrics cNMF results","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getStabilityMetrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get stability metrics from cNMF results — getStabilityMetrics","text":"","code":"getStabilityMetrics(x, name = \"cNMF\")"},{"path":"https://mictott.github.io/NMFscape/reference/getStabilityMetrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get stability metrics from cNMF results — getStabilityMetrics","text":"x SingleCellExperiment object cNMF results name Character, name cNMF result extract (default \"cNMF\")","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getStabilityMetrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get stability metrics from cNMF results — getStabilityMetrics","text":"Data frame stability metrics k value","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getStabilityMetrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get stability metrics from cNMF results — getStabilityMetrics","text":"","code":"# sce <- runConsensusNMF(sce, k_range = 5:10) # metrics <- getStabilityMetrics(sce)"},{"path":"https://mictott.github.io/NMFscape/reference/getTopFeatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate feature loadings (which genes contribute most to each factor) — getTopFeatures","title":"Calculate feature loadings (which genes contribute most to each factor) — getTopFeatures","text":"Calculate feature loadings (genes contribute factor)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getTopFeatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate feature loadings (which genes contribute most to each factor) — getTopFeatures","text":"","code":"getTopFeatures(x, name = \"NMF\", n = 10)"},{"path":"https://mictott.github.io/NMFscape/reference/getTopFeatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate feature loadings (which genes contribute most to each factor) — getTopFeatures","text":"x SingleCellExperiment object NMF results name Character, name NMF result use (default \"NMF\") n Integer, number top features return per factor (default 10)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getTopFeatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate feature loadings (which genes contribute most to each factor) — getTopFeatures","text":"List character vectors, containing top features factor","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getTopFeatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate feature loadings (which genes contribute most to each factor) — getTopFeatures","text":"","code":"library(scuttle) sce <- mockSCE(ngenes = 100, ncells = 50) sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 3, verbose = FALSE) top_genes <- getTopFeatures(sce, n = 10) head(top_genes[[1]]) #> [1] \"Gene_0031\" \"Gene_0015\" \"Gene_0016\" \"Gene_0075\" \"Gene_0003\" \"Gene_0040\""},{"path":"https://mictott.github.io/NMFscape/reference/getTopGEPFeatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Get top features for each consensus gene expression program — getTopGEPFeatures","title":"Get top features for each consensus gene expression program — getTopGEPFeatures","text":"Get top features consensus gene expression program","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getTopGEPFeatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get top features for each consensus gene expression program — getTopGEPFeatures","text":"","code":"getTopGEPFeatures(x, name = \"cNMF\", k = NULL, n = 20)"},{"path":"https://mictott.github.io/NMFscape/reference/getTopGEPFeatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get top features for each consensus gene expression program — getTopGEPFeatures","text":"x SingleCellExperiment object cNMF results name Character, name cNMF result (default \"cNMF\") k Integer, k value use. NULL, uses optimal k n Integer, number top features per program (default 20)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getTopGEPFeatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get top features for each consensus gene expression program — getTopGEPFeatures","text":"List character vectors, top features GEP","code":""},{"path":"https://mictott.github.io/NMFscape/reference/getTopGEPFeatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get top features for each consensus gene expression program — getTopGEPFeatures","text":"","code":"# sce <- runConsensusNMF(sce, k_range = 5:10) # top_genes <- getTopGEPFeatures(sce, n = 20)"},{"path":"https://mictott.github.io/NMFscape/reference/greedyMatching.html","id":null,"dir":"Reference","previous_headings":"","what":"Greedy matching for larger k — greedyMatching","title":"Greedy matching for larger k — greedyMatching","text":"Greedy matching larger k","code":""},{"path":"https://mictott.github.io/NMFscape/reference/greedyMatching.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Greedy matching for larger k — greedyMatching","text":"","code":"greedyMatching(cor_mat)"},{"path":"https://mictott.github.io/NMFscape/reference/greedyMatching.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Greedy matching for larger k — greedyMatching","text":"cor_mat Correlation matrix","code":""},{"path":"https://mictott.github.io/NMFscape/reference/greedyMatching.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Greedy matching for larger k — greedyMatching","text":"Best permutation vector","code":""},{"path":"https://mictott.github.io/NMFscape/reference/permutations.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate all permutations for small k — permutations","title":"Generate all permutations for small k — permutations","text":"Generate permutations small k","code":""},{"path":"https://mictott.github.io/NMFscape/reference/permutations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate all permutations for small k — permutations","text":"","code":"permutations(k)"},{"path":"https://mictott.github.io/NMFscape/reference/permutations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate all permutations for small k — permutations","text":"k Integer, number elements","code":""},{"path":"https://mictott.github.io/NMFscape/reference/permutations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate all permutations for small k — permutations","text":"Matrix permutations","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotDEPsHeatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot heatmap of differentially expressed programs across groups — plotDEPsHeatmap","title":"Plot heatmap of differentially expressed programs across groups — plotDEPsHeatmap","text":"Creates heatmap showing log fold change NMF program usage across cell groups (e.g., cell types) using results FindAllDEPs. Stars indicate programs log fold change threshold. Log fold change calculated log2(fold_enrichment) differential expression analysis.","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotDEPsHeatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot heatmap of differentially expressed programs across groups — plotDEPsHeatmap","text":"","code":"plotDEPsHeatmap(   deps_results,   programs = NULL,   logfc_threshold = 1,   color_palette = c(\"dodgerblue\", \"white\", \"red\"),   cluster_rows = FALSE,   cluster_cols = FALSE,   show_rownames = TRUE,   show_colnames = TRUE,   star_size = 14,   ... )"},{"path":"https://mictott.github.io/NMFscape/reference/plotDEPsHeatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot heatmap of differentially expressed programs across groups — plotDEPsHeatmap","text":"deps_results SimpleList list DataFrames FindAllDEPs() programs Character vector programs plot. NULL (default), plots programs logfc_threshold Numeric, log2 fold change threshold marking stars (default 1) color_palette Character vector length 3 low, mid, high colors (default c(\"blue\", \"white\", \"red\")) cluster_rows Logical, whether cluster programs (default FALSE) cluster_cols Logical, whether cluster groups (default FALSE) show_rownames Logical, whether show program names (default TRUE) show_colnames Logical, whether show group names (default TRUE) star_size Numeric, size star markers (default 8) ... Additional arguments passed pheatmap::pheatmap","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotDEPsHeatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot heatmap of differentially expressed programs across groups — plotDEPsHeatmap","text":"pheatmap object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotDEPsHeatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot heatmap of differentially expressed programs across groups — plotDEPsHeatmap","text":"","code":"library(scuttle) sce <- mockSCE(ngenes = 500, ncells = 200) sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 5, verbose = FALSE)  # Add mock cell type labels sce$celltype <- sample(c(\"TypeA\", \"TypeB\", \"TypeC\"), ncol(sce), replace = TRUE)  # Find differentially expressed programs deps <- FindAllDEPs(sce, cell_type_col = \"celltype\")  # Plot enrichment heatmap plotDEPsHeatmap(deps)   # Plot with custom threshold plotDEPsHeatmap(deps, logfc_threshold = 0.5)   # Plot specific programs plotDEPsHeatmap(deps, programs = c(\"NMF_1\", \"NMF_2\", \"NMF_3\"))"},{"path":"https://mictott.github.io/NMFscape/reference/plotDEPsVolcano.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize Differentially Expressed Programs with volcano plots — plotDEPsVolcano","title":"Visualize Differentially Expressed Programs with volcano plots — plotDEPsVolcano","text":"Creates volcano plots showing fold enrichment vs. statistical significance differentially expressed NMF programs across cell types.","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotDEPsVolcano.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize Differentially Expressed Programs with volcano plots — plotDEPsVolcano","text":"","code":"plotDEPsVolcano(   deps_results,   cell_types = NULL,   fold_threshold = 1.5,   pval_threshold = 0.05,   top_n = 5,   ncol = 3 )"},{"path":"https://mictott.github.io/NMFscape/reference/plotDEPsVolcano.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize Differentially Expressed Programs with volcano plots — plotDEPsVolcano","text":"deps_results List DataFrames FindAllDEPs() cell_types Character vector, cell types plot (default: ) fold_threshold Numeric, fold enrichment threshold significance (default 1.5) pval_threshold Numeric, p-value threshold significance (default 0.05) top_n Integer, number top programs label (default 5) ncol Integer, number columns faceting (default 3)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotDEPsVolcano.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize Differentially Expressed Programs with volcano plots — plotDEPsVolcano","text":"ggplot object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotDEPsVolcano.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize Differentially Expressed Programs with volcano plots — plotDEPsVolcano","text":"","code":"library(scuttle) sce <- mockSCE(ngenes = 100, ncells = 50) sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 3, verbose = FALSE) sce$celltype <- sample(c(\"A\", \"B\"), ncol(sce), replace = TRUE) deps <- FindAllDEPs(sce, cell_type_col = \"celltype\") plotDEPsVolcano(deps)"},{"path":"https://mictott.github.io/NMFscape/reference/plotGEPUsage.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot GEP usage in reduced dimension space — plotGEPUsage","title":"Plot GEP usage in reduced dimension space — plotGEPUsage","text":"Plot GEP usage reduced dimension space","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotGEPUsage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot GEP usage in reduced dimension space — plotGEPUsage","text":"","code":"plotGEPUsage(x, name = \"cNMF\", k = NULL, programs = 1:4, reduction = \"UMAP\")"},{"path":"https://mictott.github.io/NMFscape/reference/plotGEPUsage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot GEP usage in reduced dimension space — plotGEPUsage","text":"x SingleCellExperiment object cNMF results name Character, name cNMF result (default \"cNMF\") k Integer, k value use. NULL, uses optimal k programs Integer vector, programs plot (default 1:4) reduction Character, reducedDim use coordinates (default \"UMAP\")","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotGEPUsage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot GEP usage in reduced dimension space — plotGEPUsage","text":"ggplot2 object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotGEPUsage.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot GEP usage in reduced dimension space — plotGEPUsage","text":"","code":"# sce <- runConsensusNMF(sce, k_range = 5:10) # sce <- runUMAP(sce) # plotGEPUsage(sce, programs = 1:4, reduction = \"UMAP\")"},{"path":"https://mictott.github.io/NMFscape/reference/plotGEPs.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot gene expression programs (GEPs) heatmap — plotGEPs","title":"Plot gene expression programs (GEPs) heatmap — plotGEPs","text":"Plot gene expression programs (GEPs) heatmap","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotGEPs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot gene expression programs (GEPs) heatmap — plotGEPs","text":"","code":"plotGEPs(x, name = \"cNMF\", k = NULL, programs = NULL, n_genes = 20)"},{"path":"https://mictott.github.io/NMFscape/reference/plotGEPs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot gene expression programs (GEPs) heatmap — plotGEPs","text":"x SingleCellExperiment object cNMF results name Character, name cNMF result (default \"cNMF\") k Integer, k value plot. NULL, uses optimal k programs Integer vector, programs plot (default ) n_genes Integer, number top genes per program show (default 20)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotGEPs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot gene expression programs (GEPs) heatmap — plotGEPs","text":"ggplot2 object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotGEPs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot gene expression programs (GEPs) heatmap — plotGEPs","text":"","code":"# sce <- runConsensusNMF(sce, k_range = 5:10) # plotGEPs(sce, programs = 1:3, n_genes = 15)"},{"path":"https://mictott.github.io/NMFscape/reference/plotProgramDots.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot dot plot of NMF program weights by group — plotProgramDots","title":"Plot dot plot of NMF program weights by group — plotProgramDots","text":"Creates dot plot showing NMF program usage across cell groups (e.g., cell types). Color represents sum program weight group, dot size represents percentage cells non-zero weights.","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotProgramDots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot dot plot of NMF program weights by group — plotProgramDots","text":"","code":"plotProgramDots(   x,   group,   nmf_name = \"NMF\",   programs = NULL,   scale = FALSE,   min_pct = 0,   color_palette = c(\"lightgrey\", \"blue\"),   dot_scale = 6 )"},{"path":"https://mictott.github.io/NMFscape/reference/plotProgramDots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot dot plot of NMF program weights by group — plotProgramDots","text":"x SingleCellExperiment object NMF results group Character, column name colData(x) defining cell groups (e.g., \"celltype\") nmf_name Character, name NMF result use (default \"NMF\") programs Integer vector programs plot. NULL (default), plots programs scale Logical, whether scale program weights 0-1 per program (default TRUE) min_pct Numeric, minimum percentage cells (0-100) required show dot (default 0) color_palette Character vector length 2 low high colors (default c(\"lightgrey\", \"blue\")) dot_scale Numeric, scaling factor dot sizes (default 6)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotProgramDots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot dot plot of NMF program weights by group — plotProgramDots","text":"ggplot object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotProgramDots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot dot plot of NMF program weights by group — plotProgramDots","text":"","code":"library(scuttle) sce <- mockSCE(ngenes = 500, ncells = 200) sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 5, verbose = FALSE)  # Add mock cell type labels sce$celltype <- sample(c(\"TypeA\", \"TypeB\", \"TypeC\"), ncol(sce), replace = TRUE)  # Plot all programs across cell types plotProgramDots(sce, group = \"celltype\")   # Plot specific programs plotProgramDots(sce, group = \"celltype\", programs = c(1, 3, 5))   # Without scaling plotProgramDots(sce, group = \"celltype\", scale = FALSE)"},{"path":"https://mictott.github.io/NMFscape/reference/plotProgramHeatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot heatmap of top genes per NMF program — plotProgramHeatmap","title":"Plot heatmap of top genes per NMF program — plotProgramHeatmap","text":"Creates heatmap showing weights top-ranked genes NMF program. Genes ranked loadings basis matrix (W) displayed weights across programs.","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotProgramHeatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot heatmap of top genes per NMF program — plotProgramHeatmap","text":"","code":"plotProgramHeatmap(   x,   nmf_name = \"NMF\",   n_genes = 10,   make_unique = TRUE,   scale_rows = TRUE,   cluster_rows = TRUE,   cluster_cols = FALSE,   show_rownames = TRUE,   color_palette = c(\"dodgerblue\", \"white\", \"red\"),   ... )"},{"path":"https://mictott.github.io/NMFscape/reference/plotProgramHeatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot heatmap of top genes per NMF program — plotProgramHeatmap","text":"x SingleCellExperiment object NMF results nmf_name Character, name NMF result use (default \"NMF\") n_genes Integer, number top genes show per program (default 10) make_unique Logical, whether select unique top genes per program (default TRUE). TRUE, genes iteratively assigned programs based highest weight, ensuring gene appears . FALSE, genes can appear multiple programs. scale_rows Logical, whether scale gene weights across programs (default TRUE) cluster_rows Logical, whether cluster genes (default TRUE) cluster_cols Logical, whether cluster programs (default FALSE) show_rownames Logical, whether show gene names (default TRUE) color_palette Character vector length 3 low, mid, high colors (default c(\"#2166ac\", \"white\", \"#b2182b\") - diverging blue-white-red palette) ... Additional arguments passed pheatmap::pheatmap","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotProgramHeatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot heatmap of top genes per NMF program — plotProgramHeatmap","text":"pheatmap object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotProgramHeatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot heatmap of top genes per NMF program — plotProgramHeatmap","text":"","code":"library(scuttle) sce <- mockSCE(ngenes = 500, ncells = 200) sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 5, verbose = FALSE)  # Plot top 10 unique genes per program (default) plotProgramHeatmap(sce, n_genes = 10)   # Allow shared genes across programs plotProgramHeatmap(sce, n_genes = 10, make_unique = FALSE)   # Plot top 5 genes without scaling plotProgramHeatmap(sce, n_genes = 5, scale_rows = FALSE)   # Custom colors plotProgramHeatmap(sce, n_genes = 8,                    color_palette = c(\"navy\", \"white\", \"darkred\"))"},{"path":"https://mictott.github.io/NMFscape/reference/plotStability.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot stability metrics from consensus NMF — plotStability","title":"Plot stability metrics from consensus NMF — plotStability","text":"Plot stability metrics consensus NMF","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotStability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot stability metrics from consensus NMF — plotStability","text":"","code":"plotStability(   x,   name = \"cNMF\",   metrics = c(\"stability\", \"silhouette\", \"reproducibility\") )"},{"path":"https://mictott.github.io/NMFscape/reference/plotStability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot stability metrics from consensus NMF — plotStability","text":"x SingleCellExperiment object cNMF results name Character, name cNMF result (default \"cNMF\") metrics Character vector, metrics plot (default )","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotStability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot stability metrics from consensus NMF — plotStability","text":"ggplot2 object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotStability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot stability metrics from consensus NMF — plotStability","text":"","code":"# sce <- runConsensusNMF(sce, k_range = 5:10) # plotStability(sce)"},{"path":"https://mictott.github.io/NMFscape/reference/plotStabilityComparison.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot comparison of stability metrics across different k values — plotStabilityComparison","title":"Plot comparison of stability metrics across different k values — plotStabilityComparison","text":"Plot comparison stability metrics across different k values","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotStabilityComparison.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot comparison of stability metrics across different k values — plotStabilityComparison","text":"","code":"plotStabilityComparison(x, name = \"cNMF\")"},{"path":"https://mictott.github.io/NMFscape/reference/plotStabilityComparison.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot comparison of stability metrics across different k values — plotStabilityComparison","text":"x SingleCellExperiment object cNMF results name Character, name cNMF result (default \"cNMF\")","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotStabilityComparison.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot comparison of stability metrics across different k values — plotStabilityComparison","text":"ggplot2 object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/plotStabilityComparison.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot comparison of stability metrics across different k values — plotStabilityComparison","text":"","code":"# sce <- runConsensusNMF(sce, k_range = 5:15) # plotStabilityComparison(sce)"},{"path":"https://mictott.github.io/NMFscape/reference/reconstructNMF.html","id":null,"dir":"Reference","previous_headings":"","what":"Reconstruct original matrix from NMF factors — reconstructNMF","title":"Reconstruct original matrix from NMF factors — reconstructNMF","text":"Reconstruct original matrix NMF factors","code":""},{"path":"https://mictott.github.io/NMFscape/reference/reconstructNMF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reconstruct original matrix from NMF factors — reconstructNMF","text":"","code":"reconstructNMF(x, name = \"NMF\")"},{"path":"https://mictott.github.io/NMFscape/reference/reconstructNMF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reconstruct original matrix from NMF factors — reconstructNMF","text":"x SingleCellExperiment object NMF results name Character, name NMF result use (default \"NMF\")","code":""},{"path":"https://mictott.github.io/NMFscape/reference/reconstructNMF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reconstruct original matrix from NMF factors — reconstructNMF","text":"Reconstructed matrix (basis","code":""},{"path":"https://mictott.github.io/NMFscape/reference/reconstructNMF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reconstruct original matrix from NMF factors — reconstructNMF","text":"","code":"library(scuttle) sce <- mockSCE(ngenes = 100, ncells = 50) sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 3, verbose = FALSE) reconstructed <- reconstructNMF(sce) dim(reconstructed) #> [1] 100  50"},{"path":"https://mictott.github.io/NMFscape/reference/refitUsageMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Refit usage matrix using consensus spectra via non-negative least squares — refitUsageMatrix","title":"Refit usage matrix using consensus spectra via non-negative least squares — refitUsageMatrix","text":"step ensures final usage matrix optimally fitted original data using consensus gene expression programs","code":""},{"path":"https://mictott.github.io/NMFscape/reference/refitUsageMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Refit usage matrix using consensus spectra via non-negative least squares — refitUsageMatrix","text":"","code":"refitUsageMatrix(data_matrix, consensus_spectra)"},{"path":"https://mictott.github.io/NMFscape/reference/refitUsageMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Refit usage matrix using consensus spectra via non-negative least squares — refitUsageMatrix","text":"data_matrix Original data matrix (features x samples) consensus_spectra Consensus basis matrix (features x factors)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/refitUsageMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Refit usage matrix using consensus spectra via non-negative least squares — refitUsageMatrix","text":"Refitted usage matrix (factors x samples)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/runConsensusNMF.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Consensus Non-negative Matrix Factorization on SingleCellExperiment objects — runConsensusNMF","title":"Run Consensus Non-negative Matrix Factorization on SingleCellExperiment objects — runConsensusNMF","text":"Performs consensus NMF (cNMF) running multiple NMF iterations combining results identify stable gene expression programs. approach increases robustness accuracy compared single NMF runs.","code":""},{"path":"https://mictott.github.io/NMFscape/reference/runConsensusNMF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Consensus Non-negative Matrix Factorization on SingleCellExperiment objects — runConsensusNMF","text":"","code":"runConsensusNMF(   x,   k_range = 5:15,   n_runs = 100,   assay = \"logcounts\",   name = \"cNMF\",   subset_row = NULL,   tol = 1e-05,   maxit = 100,   L1 = c(0, 0),   seed = NULL,   verbose = TRUE,   n_cores = 1,   ... )"},{"path":"https://mictott.github.io/NMFscape/reference/runConsensusNMF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Consensus Non-negative Matrix Factorization on SingleCellExperiment objects — runConsensusNMF","text":"x SingleCellExperiment SpatialExperiment object k_range Integer vector, range K values test (default 5:15) n_runs Integer, number NMF runs per K value (default 100) assay Character integer, assay use (default \"logcounts\") name Character, name storing results (default \"cNMF\") subset_row Vector specifying features use tol Numeric, tolerance convergence (default 1e-5) maxit Integer, maximum iterations per run (default 100) L1 Numeric vector length 2, L1 regularization [w, h] (default c(0,0)) seed Integer, random seed reproducibility verbose Logical, whether print progress (default TRUE) n_cores Integer, number cores parallel processing (default 1) ... Additional arguments passed RcppML::nmf","code":""},{"path":"https://mictott.github.io/NMFscape/reference/runConsensusNMF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Consensus Non-negative Matrix Factorization on SingleCellExperiment objects — runConsensusNMF","text":"input object cNMF results stored metadata(x)$cNMF   optimal usage matrix reducedDims","code":""},{"path":"https://mictott.github.io/NMFscape/reference/runConsensusNMF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Consensus Non-negative Matrix Factorization on SingleCellExperiment objects — runConsensusNMF","text":"","code":"# Single-cell example library(scuttle) sce <- mockSCE(ngenes = 500, ncells = 200) sce <- logNormCounts(sce) sce <- runConsensusNMF(sce, k_range = 5:10, n_runs = 20) #> Running consensus NMF with k_range=5:10, n_runs=20 #> Processing k=5 (1/6) #>   Stability: 0.007, Silhouette: 0.433 #> Processing k=6 (2/6) #>   Stability: 0.006, Silhouette: 0.539 #> Processing k=7 (3/6) #>   Stability: 0.005, Silhouette: 0.332 #> Processing k=8 (4/6) #>   Stability: 0.001, Silhouette: 0.412 #> Processing k=9 (5/6) #>   Stability: 0, Silhouette: 0.396 #> Processing k=10 (6/6) #>   Stability: 0, Silhouette: 0.515 #> Selected optimal k=6 based on combined method #>   Stability: 0.006 #>   Silhouette: 0.539 #>   Reproducibility: 0.2 #> Consensus NMF completed. Optimal k=6 #> Results stored in metadata(x)$cNMF$cNMF #> Optimal usage stored in reducedDim(x, 'cNMF')  # Access consensus results geps <- getConsensusGEPs(sce) usage <- getGEPUsage(sce)"},{"path":"https://mictott.github.io/NMFscape/reference/runNMF.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Non-negative Matrix Factorization on SingleCellExperiment objects — runNMF","title":"Run Non-negative Matrix Factorization on SingleCellExperiment objects — runNMF","text":"Performs NMF using RcppML SingleCellExperiment SpatialExperiment objects stores results reducedDims slot metadata","code":""},{"path":"https://mictott.github.io/NMFscape/reference/runNMF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Non-negative Matrix Factorization on SingleCellExperiment objects — runNMF","text":"","code":"runNMF(   x,   k,   assay = \"logcounts\",   name = \"NMF\",   subset_row = NULL,   tol = 1e-05,   maxit = 100,   L1 = c(0, 0),   seed = NULL,   verbose = TRUE,   ... )"},{"path":"https://mictott.github.io/NMFscape/reference/runNMF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Non-negative Matrix Factorization on SingleCellExperiment objects — runNMF","text":"x SingleCellExperiment SpatialExperiment object k Integer, number factors NMF (rank) assay Character integer, assay use (default \"logcounts\") name Character, name reducedDim slot (default \"NMF\") subset_row Vector specifying features use tol Numeric, tolerance convergence (default 1e-5) maxit Integer, maximum iterations (default 100) L1 Numeric vector length 2, L1 regularization [w, h] (default c(0,0)) seed Integer, random seed reproducibility verbose Logical, whether print progress (default TRUE) ... Additional arguments passed RcppML::nmf","code":""},{"path":"https://mictott.github.io/NMFscape/reference/runNMF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Non-negative Matrix Factorization on SingleCellExperiment objects — runNMF","text":"input object NMF results stored reducedDims(x, name)   metadata stored metadata(x)$NMF","code":""},{"path":"https://mictott.github.io/NMFscape/reference/runNMF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Non-negative Matrix Factorization on SingleCellExperiment objects — runNMF","text":"","code":"# Single-cell example library(scuttle) sce <- mockSCE() sce <- logNormCounts(sce) sce <- runNMF(sce, k = 10) #> Running NMF with k=10 factors... #>  #> iter |      tol  #> --------------- #>    1 | 7.94e-01 #>    2 | 4.50e-02 #>    3 | 2.07e-02 #>    4 | 1.12e-02 #>    5 | 6.73e-03 #>    6 | 4.26e-03 #>    7 | 2.89e-03 #>    8 | 2.02e-03 #>    9 | 1.45e-03 #>   10 | 1.05e-03 #>   11 | 7.89e-04 #>   12 | 6.28e-04 #>   13 | 5.15e-04 #>   14 | 4.34e-04 #>   15 | 3.74e-04 #>   16 | 3.23e-04 #>   17 | 2.79e-04 #>   18 | 2.39e-04 #>   19 | 2.08e-04 #>   20 | 1.83e-04 #>   21 | 1.60e-04 #>   22 | 1.41e-04 #>   23 | 1.23e-04 #>   24 | 1.10e-04 #>   25 | 9.85e-05 #>   26 | 8.81e-05 #>   27 | 7.89e-05 #>   28 | 7.14e-05 #>   29 | 6.50e-05 #>   30 | 5.84e-05 #>   31 | 5.23e-05 #>   32 | 4.69e-05 #>   33 | 4.24e-05 #>   34 | 3.87e-05 #>   35 | 3.55e-05 #>   36 | 3.28e-05 #>   37 | 3.00e-05 #>   38 | 2.77e-05 #>   39 | 2.57e-05 #>   40 | 2.39e-05 #>   41 | 2.22e-05 #>   42 | 2.08e-05 #>   43 | 1.94e-05 #>   44 | 1.83e-05 #>   45 | 1.73e-05 #>   46 | 1.63e-05 #>   47 | 1.55e-05 #>   48 | 1.47e-05 #>   49 | 1.42e-05 #>   50 | 1.37e-05 #>   51 | 1.32e-05 #>   52 | 1.28e-05 #>   53 | 1.24e-05 #>   54 | 1.22e-05 #>   55 | 1.19e-05 #>   56 | 1.15e-05 #>   57 | 1.11e-05 #>   58 | 1.08e-05 #>   59 | 1.06e-05 #>   60 | 1.03e-05 #>   61 | 1.00e-05 #>   62 | 9.76e-06 #> NMF completed. Results stored in reducedDim(x, 'NMF') #> Basis matrix stored in metadata(x)$NMF_basis  # Access NMF coefficients (cell loadings) nmf_coords <- reducedDim(sce, \"NMF\")  # Access basis matrix from metadata basis <- metadata(sce)$NMF_basis"},{"path":"https://mictott.github.io/NMFscape/reference/runNMFscape.html","id":null,"dir":"Reference","previous_headings":"","what":"Run NMFscape Non-negative Matrix Factorization on SingleCellExperiment objects — runNMFscape","title":"Run NMFscape Non-negative Matrix Factorization on SingleCellExperiment objects — runNMFscape","text":"Performs NMF using RcppML SingleCellExperiment SpatialExperiment objects stores results reducedDims slot metadata","code":""},{"path":"https://mictott.github.io/NMFscape/reference/runNMFscape.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run NMFscape Non-negative Matrix Factorization on SingleCellExperiment objects — runNMFscape","text":"","code":"runNMFscape(   x,   k,   assay = \"logcounts\",   name = \"NMF\",   subset_row = NULL,   tol = 1e-05,   maxit = 100,   L1 = c(0, 0),   seed = NULL,   verbose = TRUE,   ... )"},{"path":"https://mictott.github.io/NMFscape/reference/runNMFscape.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run NMFscape Non-negative Matrix Factorization on SingleCellExperiment objects — runNMFscape","text":"x SingleCellExperiment SpatialExperiment object k Integer, number factors NMF (rank) assay Character integer, assay use (default \"logcounts\") name Character, name reducedDim slot (default \"NMF\") subset_row Vector specifying features use tol Numeric, tolerance convergence (default 1e-5) maxit Integer, maximum iterations (default 100) L1 Numeric vector length 2, L1 regularization [w, h] (default c(0,0)) seed Integer, random seed reproducibility verbose Logical, whether print progress (default TRUE) ... Additional arguments passed RcppML::nmf","code":""},{"path":"https://mictott.github.io/NMFscape/reference/runNMFscape.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run NMFscape Non-negative Matrix Factorization on SingleCellExperiment objects — runNMFscape","text":"input object NMF results stored reducedDims(x, name)   metadata stored metadata(x)$NMF","code":""},{"path":"https://mictott.github.io/NMFscape/reference/runNMFscape.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run NMFscape Non-negative Matrix Factorization on SingleCellExperiment objects — runNMFscape","text":"","code":"# Single-cell example library(scuttle) sce <- mockSCE() sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 10) #> Running NMF with k=10 factors... #> NMF completed. Results stored in reducedDim(x, 'NMF') #> Basis matrix stored in metadata(x)$NMF_basis  # Access NMF coefficients (cell loadings) nmf_coords <- reducedDim(sce, \"NMF\")  # Access basis matrix from metadata basis <- metadata(sce)$NMF_basis"},{"path":"https://mictott.github.io/NMFscape/reference/selectOptimalK.html","id":null,"dir":"Reference","previous_headings":"","what":"Select optimal K from stability metrics — selectOptimalK","title":"Select optimal K from stability metrics — selectOptimalK","text":"Select optimal K stability metrics","code":""},{"path":"https://mictott.github.io/NMFscape/reference/selectOptimalK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select optimal K from stability metrics — selectOptimalK","text":"","code":"selectOptimalK(stability_metrics, method = \"combined\", verbose = TRUE)"},{"path":"https://mictott.github.io/NMFscape/reference/selectOptimalK.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select optimal K from stability metrics — selectOptimalK","text":"stability_metrics Data frame k, stability, silhouette, reproducibility method Character, method selection (default \"combined\") verbose Logical, whether print selection details","code":""},{"path":"https://mictott.github.io/NMFscape/reference/selectOptimalK.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select optimal K from stability metrics — selectOptimalK","text":"Integer, optimal k value","code":""},{"path":"https://mictott.github.io/NMFscape/reference/solveNNLS.html","id":null,"dir":"Reference","previous_headings":"","what":"Solve non-negative least squares problem — solveNNLS","title":"Solve non-negative least squares problem — solveNNLS","text":"Solves min ||Ax - b||^2 subject x >= 0","code":""},{"path":"https://mictott.github.io/NMFscape/reference/solveNNLS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Solve non-negative least squares problem — solveNNLS","text":"","code":"solveNNLS(A, b)"},{"path":"https://mictott.github.io/NMFscape/reference/solveNNLS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Solve non-negative least squares problem — solveNNLS","text":"Matrix (features x factors) b Vector b (features)","code":""},{"path":"https://mictott.github.io/NMFscape/reference/solveNNLS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Solve non-negative least squares problem — solveNNLS","text":"Non-negative solution vector x","code":""},{"path":"https://mictott.github.io/NMFscape/reference/vizDimRed.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize NMF programs on dimension reduction plots — vizDimRed","title":"Visualize NMF programs on dimension reduction plots — vizDimRed","text":"Plot NMF program usage dimension reduction coordinates (UMAP, PCA, etc.) flexible color mapping customization options.","code":""},{"path":"https://mictott.github.io/NMFscape/reference/vizDimRed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize NMF programs on dimension reduction plots — vizDimRed","text":"","code":"vizDimRed(   x,   dimred = \"UMAP\",   nmf_name = \"NMF\",   program = 1,   point_size = 0.8,   alpha = 1,   color_scale = \"viridis\",   dims = c(1, 2) )"},{"path":"https://mictott.github.io/NMFscape/reference/vizDimRed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize NMF programs on dimension reduction plots — vizDimRed","text":"x SingleCellExperiment object NMF results dimension reduction dimred Character, name dimension reduction use (default \"UMAP\") nmf_name Character, name NMF result use (default \"NMF\") program Character integer, NMF program plot (e.g., \"NMF_1\", \"NMF_4\", 4) point_size Numeric, size points (default 0.8) alpha Numeric, transparency points (default 1.0) color_scale Character, color scale use: \"viridis\", \"plasma\", \"inferno\", \"magma\", custom (default \"viridis\") dims Integer vector length 2, dimensions plot (default c(1,2))","code":""},{"path":"https://mictott.github.io/NMFscape/reference/vizDimRed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize NMF programs on dimension reduction plots — vizDimRed","text":"ggplot object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/vizDimRed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize NMF programs on dimension reduction plots — vizDimRed","text":"","code":"# Basic usage library(scuttle) sce <- mockSCE() sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 5) #> Running NMF with k=5 factors... #> NMF completed. Results stored in reducedDim(x, 'NMF') #> Basis matrix stored in metadata(x)$NMF_basis sce <- runUMAP(sce) #> Error in runUMAP(sce): could not find function \"runUMAP\"  # Plot NMF program 1 on UMAP vizDimRed(sce, program = 1) #> Error in vizDimRed(sce, program = 1): Dimension reduction 'UMAP' not found in reducedDims(x). Available: NMF  # Plot specific program by name vizDimRed(sce, program = \"NMF_4\") #> Error in vizDimRed(sce, program = \"NMF_4\"): Dimension reduction 'UMAP' not found in reducedDims(x). Available: NMF  # Use PCA instead of UMAP sce <- runPCA(sce) #> Error in runPCA(sce): could not find function \"runPCA\" vizDimRed(sce, dimred = \"PCA\", program = 2) #> Error in vizDimRed(sce, dimred = \"PCA\", program = 2): Dimension reduction 'PCA' not found in reducedDims(x). Available: NMF"},{"path":"https://mictott.github.io/NMFscape/reference/vizUMAP.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize NMF programs on UMAP coordinates — vizUMAP","title":"Visualize NMF programs on UMAP coordinates — vizUMAP","text":"Convenience function plot NMF program usage UMAP coordinates. wrapper around vizDimRed() specifically UMAP plotting.","code":""},{"path":"https://mictott.github.io/NMFscape/reference/vizUMAP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize NMF programs on UMAP coordinates — vizUMAP","text":"","code":"vizUMAP(   x,   nmf_name = \"NMF\",   program = 1,   point_size = 0.8,   alpha = 1,   color_scale = \"viridis\" )"},{"path":"https://mictott.github.io/NMFscape/reference/vizUMAP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize NMF programs on UMAP coordinates — vizUMAP","text":"x SingleCellExperiment object NMF results UMAP coordinates nmf_name Character, name NMF result use (default \"NMF\") program Character integer, NMF program plot (e.g., \"NMF_1\", \"NMF_4\", 4) point_size Numeric, size points (default 0.8) alpha Numeric, transparency points (default 1.0) color_scale Character, color scale use: \"viridis\", \"plasma\", \"inferno\", \"magma\" (default \"viridis\")","code":""},{"path":"https://mictott.github.io/NMFscape/reference/vizUMAP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize NMF programs on UMAP coordinates — vizUMAP","text":"ggplot object","code":""},{"path":"https://mictott.github.io/NMFscape/reference/vizUMAP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize NMF programs on UMAP coordinates — vizUMAP","text":"","code":"# Basic usage library(scuttle) sce <- mockSCE() sce <- logNormCounts(sce) sce <- runNMFscape(sce, k = 5) #> Running NMF with k=5 factors... #> NMF completed. Results stored in reducedDim(x, 'NMF') #> Basis matrix stored in metadata(x)$NMF_basis sce <- runUMAP(sce) #> Error in runUMAP(sce): could not find function \"runUMAP\"  # Plot NMF program 1 on UMAP vizUMAP(sce, program = 1) #> Error in vizDimRed(x = x, dimred = \"UMAP\", nmf_name = nmf_name, program = program,     point_size = point_size, alpha = alpha, color_scale = color_scale,     dims = c(1, 2)): Dimension reduction 'UMAP' not found in reducedDims(x). Available: NMF  # Plot specific program by name with custom styling vizUMAP(sce, program = \"NMF_4\", color_scale = \"plasma\", point_size = 1.2) #> Error in vizDimRed(x = x, dimred = \"UMAP\", nmf_name = nmf_name, program = program,     point_size = point_size, alpha = alpha, color_scale = color_scale,     dims = c(1, 2)): Dimension reduction 'UMAP' not found in reducedDims(x). Available: NMF"}]
