% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotDEPsHeatmap.R
\name{plotDEPsHeatmap}
\alias{plotDEPsHeatmap}
\title{Plot heatmap of differentially expressed programs across groups}
\usage{
plotDEPsHeatmap(
  deps_results,
  programs = NULL,
  logfc_threshold = 1,
  color_palette = c("dodgerblue", "white", "red"),
  cluster_rows = FALSE,
  cluster_cols = FALSE,
  show_rownames = TRUE,
  show_colnames = TRUE,
  star_size = 14,
  ...
)
}
\arguments{
\item{deps_results}{SimpleList or list of DataFrames from FindAllDEPs()}

\item{programs}{Character vector of programs to plot. If NULL (default), plots all programs}

\item{logfc_threshold}{Numeric, log2 fold change threshold for marking with stars (default 1)}

\item{color_palette}{Character vector of length 3 for low, mid, high colors
(default c("blue", "white", "red"))}

\item{cluster_rows}{Logical, whether to cluster programs (default FALSE)}

\item{cluster_cols}{Logical, whether to cluster groups (default FALSE)}

\item{show_rownames}{Logical, whether to show program names (default TRUE)}

\item{show_colnames}{Logical, whether to show group names (default TRUE)}

\item{star_size}{Numeric, size of star markers (default 8)}

\item{...}{Additional arguments passed to pheatmap::pheatmap}
}
\value{
A pheatmap object
}
\description{
Creates a heatmap showing log fold change of NMF program usage across cell groups
(e.g., cell types) using results from FindAllDEPs. Stars indicate programs with
log fold change above a threshold. Log fold change is calculated as log2(fold_enrichment)
from the differential expression analysis.
}
\examples{
library(scuttle)
sce <- mockSCE(ngenes = 500, ncells = 200)
sce <- logNormCounts(sce)
sce <- runNMFscape(sce, k = 5, verbose = FALSE)

# Add mock cell type labels
sce$celltype <- sample(c("TypeA", "TypeB", "TypeC"), ncol(sce), replace = TRUE)

# Find differentially expressed programs
deps <- FindAllDEPs(sce, cell_type_col = "celltype")

# Plot enrichment heatmap
plotDEPsHeatmap(deps)

# Plot with custom threshold
plotDEPsHeatmap(deps, logfc_threshold = 0.5)

# Plot specific programs
plotDEPsHeatmap(deps, programs = c("NMF_1", "NMF_2", "NMF_3"))
}
