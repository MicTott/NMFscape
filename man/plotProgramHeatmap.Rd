% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotProgramHeatmap.R
\name{plotProgramHeatmap}
\alias{plotProgramHeatmap}
\title{Plot heatmap of top genes per NMF program}
\usage{
plotProgramHeatmap(
  x,
  nmf_name = "NMF",
  programs = NULL,
  n_genes = 10,
  make_unique = TRUE,
  scale_rows = TRUE,
  cluster_rows = TRUE,
  cluster_cols = FALSE,
  show_rownames = TRUE,
  color_palette = c("dodgerblue", "white", "red"),
  ...
)
}
\arguments{
\item{x}{A SingleCellExperiment object with NMF results}

\item{nmf_name}{Character, name of NMF result to use (default "NMF")}

\item{programs}{Integer vector, specific programs to plot (default NULL for all).
Can specify program indices (e.g., c(1, 3, 5)) or names (e.g., c("GEP_1", "GEP_3"))}

\item{n_genes}{Integer, number of top genes to show per program (default 10)}

\item{make_unique}{Logical, whether to select unique top genes per program (default TRUE).
When TRUE, genes are iteratively assigned to programs based on highest weight,
ensuring each gene appears only once. When FALSE, genes can appear in multiple programs.}

\item{scale_rows}{Logical, whether to scale gene weights across programs (default TRUE)}

\item{cluster_rows}{Logical, whether to cluster genes (default TRUE)}

\item{cluster_cols}{Logical, whether to cluster programs (default FALSE)}

\item{show_rownames}{Logical, whether to show gene names (default TRUE)}

\item{color_palette}{Character vector of length 3 for low, mid, high colors
(default c("#2166ac", "white", "#b2182b") - a diverging blue-white-red palette)}

\item{...}{Additional arguments passed to pheatmap::pheatmap}
}
\value{
A pheatmap object
}
\description{
Creates a heatmap showing the weights of top-ranked genes for each NMF program.
Genes are ranked by their loadings in the basis matrix (W) and displayed with
their weights across all programs.
}
\examples{
library(scuttle)
sce <- mockSCE(ngenes = 500, ncells = 200)
sce <- logNormCounts(sce)
sce <- runNMFscape(sce, k = 5, verbose = FALSE)

# Plot top 10 unique genes per program (default)
plotProgramHeatmap(sce, n_genes = 10)

# Allow shared genes across programs
plotProgramHeatmap(sce, n_genes = 10, make_unique = FALSE)

# Plot top 5 genes without scaling
plotProgramHeatmap(sce, n_genes = 5, scale_rows = FALSE)

# Custom colors
plotProgramHeatmap(sce, n_genes = 8,
                   color_palette = c("navy", "white", "darkred"))

# Plot only specific programs
plotProgramHeatmap(sce, programs = c(1, 3, 5), n_genes = 10)
}
