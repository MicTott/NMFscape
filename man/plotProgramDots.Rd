% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotProgramDots.R
\name{plotProgramDots}
\alias{plotProgramDots}
\title{Plot dot plot of NMF program weights by group}
\usage{
plotProgramDots(
  x,
  group,
  nmf_name = "NMF",
  programs = NULL,
  scale = FALSE,
  min_pct = 0,
  color_palette = c("lightgrey", "blue"),
  dot_scale = 6
)
}
\arguments{
\item{x}{A SingleCellExperiment object with NMF results}

\item{group}{Character, column name in colData(x) defining cell groups (e.g., "celltype")}

\item{nmf_name}{Character, name of NMF result to use (default "NMF")}

\item{programs}{Integer vector of programs to plot. If NULL (default), plots all programs}

\item{scale}{Logical, whether to scale program weights to 0-1 per program (default TRUE)}

\item{min_pct}{Numeric, minimum percentage of cells (0-100) required to show a dot (default 0)}

\item{color_palette}{Character vector of length 2 for low and high colors
(default c("lightgrey", "blue"))}

\item{dot_scale}{Numeric, scaling factor for dot sizes (default 6)}
}
\value{
A ggplot object
}
\description{
Creates a dot plot showing NMF program usage across cell groups (e.g., cell types).
Color represents the sum program weight in each group, and dot size represents
the percentage of cells with non-zero weights.
}
\examples{
library(scuttle)
sce <- mockSCE(ngenes = 500, ncells = 200)
sce <- logNormCounts(sce)
sce <- runNMFscape(sce, k = 5, verbose = FALSE)

# Add mock cell type labels
sce$celltype <- sample(c("TypeA", "TypeB", "TypeC"), ncol(sce), replace = TRUE)

# Plot all programs across cell types
plotProgramDots(sce, group = "celltype")

# Plot specific programs
plotProgramDots(sce, group = "celltype", programs = c(1, 3, 5))

# Without scaling
plotProgramDots(sce, group = "celltype", scale = FALSE)
}
